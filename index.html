<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    
    <!-- Ø¥Ø¶Ø§ÙØ© manifest Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ -->
    <link rel="manifest" href="data:application/manifest+json,{
      &quot;name&quot;: &quot;Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨&quot;,
      &quot;short_name&quot;: &quot;Ø§Ù„Ø­Ø¶ÙˆØ±&quot;,
      &quot;start_url&quot;: &quot;https://yasminnmain44-design.github.io/Management/&quot;,
      &quot;display&quot;: &quot;standalone&quot;,
      &quot;background_color&quot;: &quot;#3498db&quot;,
      &quot;theme_color&quot;: &quot;#2c3e50&quot;,
      &quot;icons&quot;: [
        {
          &quot;src&quot;: &quot;https://yasminnmain44-design.github.io/Management/icon-192.png&quot;,
          &quot;sizes&quot;: &quot;192x192&quot;,
          &quot;type&quot;: &quot;image/png&quot;
        },
        {
          &quot;src&quot;: &quot;https://yasminnmain44-design.github.io/Management/icon-512.png&quot;,
          &quot;sizes&quot;: &quot;512x512&quot;,
          &quot;type&quot;: &quot;image/png&quot;
        }
      ]
    }">
    
    <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© SVG -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%233498db'/%3E%3Ctext x='50' y='70' font-size='50' text-anchor='middle' fill='white' font-family='Arial'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" type="image/svg+xml">
    
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --purple: #9b59b6;
            --orange: #e67e22;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            direction: rtl;
            overflow-x: hidden;
            font-size: 16px;
        }

        .app-container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .app-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 12px 15px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .app-title {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .header-action-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            cursor: pointer;
        }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .side-menu {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100%;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            z-index: 200;
            transition: right 0.3s ease;
            padding: 20px;
            overflow-y: auto;
        }

        .side-menu.active {
            right: 0;
        }

        .side-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .side-menu-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--secondary);
        }

        .close-menu {
            background: none;
            border: none;
            font-size: 1.3rem;
            color: #666;
            cursor: pointer;
        }

        .menu-items {
            list-style: none;
        }

        .menu-item {
            margin-bottom: 10px;
        }

        .menu-link {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: #333;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .menu-link:hover, .menu-link.active {
            background: var(--primary);
            color: white;
        }

        .menu-link i {
            margin-left: 10px;
            font-size: 1.1rem;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 150;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            right: 0;
            left: 0;
            background: white;
            display: flex;
            justify-content: space-between;
            padding: 10px 5px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #666;
            font-size: 0.7rem;
            flex: 1;
            padding: 5px 0;
            cursor: pointer;
            border-radius: 8px;
            margin: 0 2px;
            transition: all 0.3s;
            max-width: 20%;
        }

        .nav-item.active {
            color: var(--primary);
            background-color: rgba(52, 152, 219, 0.1);
        }

        .nav-icon {
            font-size: 1.1rem;
            margin-bottom: 4px;
        }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-content {
            padding: 15px;
            padding-bottom: 70px;
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            text-align: center;
            border-top: 3px solid var(--primary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 70px;
        }

        .stat-value {
            font-size: 1rem;
            font-weight: bold;
            margin: 3px 0;
            color: var(--primary);
            line-height: 1.2;
        }

        .stat-title {
            color: #666;
            font-size: 0.7rem;
            margin-bottom: 5px;
            line-height: 1.2;
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin-bottom: 15px;
            overflow: hidden;
        }

        .card-header {
            padding: 15px;
            background: var(--primary);
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-body {
            padding: 15px;
        }

        /* Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ */
        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
            font-size: 0.95rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
            background: #f9f9f9;
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            background: white;
        }

        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            font-weight: 500;
            width: 100%;
        }

        button:hover {
            background: #2980b9;
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #219653;
        }

        .btn-warning {
            background: var(--warning);
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-secondary:hover {
            background: #1a252f;
        }

        .btn-purple {
            background: var(--purple);
        }

        .btn-purple:hover {
            background: #8e44ad;
        }

        .btn-orange {
            background: var(--orange);
        }

        .btn-orange:hover {
            background: #d35400;
        }

        /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin-bottom: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 500px;
        }

        th, td {
            padding: 12px 10px;
            text-align: right;
            border-bottom: 1px solid #e0e0e0;
            font-size: 0.9rem;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #555;
        }

        tr:hover {
            background-color: #f9f9f9;
        }

        .actions {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .actions button {
            padding: 8px 12px;
            font-size: 0.85rem;
            width: 100%;
        }

        /* Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
            overflow-x: auto;
        }

        .tab {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 500;
            white-space: nowrap;
        }

        .tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± */
        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
            flex-wrap: wrap;
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .item-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 200px;
        }

        .item-title {
            font-weight: 600;
            margin-bottom: 0;
        }

        .item-subtitle {
            color: #666;
            font-size: 0.9rem;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .item-subtitle span {
            display: inline-block;
        }

        .item-actions {
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 120px;
            margin-right: auto;
            margin-left: 10px;
        }

        .status-present {
            color: var(--success);
            font-weight: bold;
        }

        .status-absent {
            color: var(--danger);
            font-weight: bold;
        }

        .status-leave {
            color: var(--warning);
            font-weight: bold;
        }

        .status-fixed {
            color: var(--success);
            font-weight: bold;
        }

        .status-in-progress {
            color: var(--warning);
            font-weight: bold;
        }

        .status-pending {
            color: var(--danger);
            font-weight: bold;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹ */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .quick-action {
            background: white;
            border-radius: 8px;
            padding: 10px 5px;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            min-height: 70px;
        }

        .quick-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .quick-action i {
            font-size: 1.2rem;
            margin-bottom: 5px;
            color: var(--primary);
        }

        .quick-action span {
            font-weight: 600;
            font-size: 0.75rem;
            line-height: 1.2;
        }

        .see-all {
            font-size: 0.9rem;
            cursor: pointer;
            opacity: 0.8;
        }

        .see-all:hover {
            opacity: 1;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
        .btn-edit {
            background: var(--warning);
        }
        
        .btn-edit:hover {
            background: #e67e22;
        }
        
        .btn-delete {
            background: var(--danger);
        }
        
        .btn-delete:hover {
            background: #c0392b;
        }

        .btn-activate {
            background: var(--success);
        }
        
        .btn-activate:hover {
            background: #219653;
        }

        .btn-deactivate {
            background: #95a5a6;
        }
        
        .btn-deactivate:hover {
            background: #7f8c8d;
        }

        /* Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ */
        .btn-whatsapp {
            background: #25D366;
        }
        
        .btn-whatsapp:hover {
            background: #128C7E;
        }

        /* Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„ */
        .btn-call {
            background: #3498db;
        }
        
        .btn-call:hover {
            background: #2980b9;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 360px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .main-content {
                padding: 10px;
                padding-bottom: 70px;
            }
            
            .app-title {
                font-size: 1.1rem;
            }
            
            .stat-card, .quick-action {
                min-height: 65px;
            }
            
            .stat-value {
                font-size: 0.9rem;
            }
            
            .stat-title, .quick-action span {
                font-size: 0.65rem;
            }
            
            .item-actions {
                min-width: 100%;
                margin-top: 10px;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© */
        @media (min-width: 768px) {
            .app-container {
                max-width: 500px;
                margin: 0 auto;
            }
            
            .stats-container, .quick-actions {
                gap: 12px;
            }
            
            .stat-card, .quick-action {
                min-height: 80px;
            }
        }

        /* Ø²Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ */
        .backup-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .backup-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .backup-buttons button {
            flex: 1;
        }
        
        .empty-state {
            text-align: center;
            color: #666;
            padding: 20px;
            font-style: italic;
        }

        /* Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ¸Ù */
        .employee-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .status-active {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success);
        }
        
        .status-inactive {
            background-color: rgba(149, 165, 166, 0.1);
            color: #7f8c8d;
        }

        /* ØµÙØ­Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† */
        .employee-details-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin-bottom: 15px;
            overflow: hidden;
        }

        .employee-details-header {
            padding: 15px;
            background: var(--primary);
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .employee-details-body {
            padding: 15px;
        }

        .employee-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            font-weight: 600;
            color: #555;
            margin-bottom: 5px;
        }

        .info-value {
            color: #333;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .employee-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .employee-actions button {
            flex: 1;
            min-width: 80px;
            padding: 10px 8px;
            font-size: 0.8rem;
            white-space: nowrap;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„Ù…Ø¹Ø¯Ù„ */
        .nav-item-attendance {
            background-color: var(--success);
            color: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: -20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .nav-item-attendance .nav-icon {
            font-size: 1.3rem;
            margin-bottom: 0;
        }

        .nav-item-attendance .nav-text {
            display: none;
        }

        /* Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .add-employee-db {
            margin-bottom: 20px;
        }

        /* Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .connection-status {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
        }

        .connection-online {
            background-color: var(--success);
            color: white;
        }

        .connection-offline {
            background-color: var(--danger);
            color: white;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„ØµÙØ­Ø© Ø§Ù„Ø¹Ù‡Ø¯Ø© */
        .cash-tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
            overflow-x: auto;
        }
        
        .cash-tab {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .cash-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }
        
        .cash-tab-content {
            display: none;
        }
        
        .cash-tab-content.active {
            display: block;
        }
        
        .cash-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .cash-summary-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            border-top: 3px solid var(--primary);
        }
        
        .cash-summary-value {
            font-size: 1.2rem;
            font-weight: bold;
            margin: 5px 0;
            color: var(--primary);
        }
        
        .cash-summary-label {
            color: #666;
            font-size: 0.8rem;
        }
        
        .validation-error {
            color: var(--danger);
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
        }
        
        .input-error {
            border-color: var(--danger);
        }
        
        .hidden {
            display: none;
        }

        /* Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø®Ø§ØµÙŠØ© Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ */
        .import-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .import-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .import-actions button {
            flex: 1;
        }

        .import-preview {
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            background-color: #f9f9f9;
        }

        .import-preview table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .import-preview th, .import-preview td {
            padding: 8px;
            text-align: right;
            border-bottom: 1px solid #e0e0e0;
        }

        .import-preview th {
            background-color: #f0f0f0;
            font-weight: 600;
        }

        .import-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .import-success {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success);
            border: 1px solid rgba(39, 174, 96, 0.3);
        }

        .import-error {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .import-warning {
            background-color: rgba(243, 156, 18, 0.1);
            color: var(--warning);
            border: 1px solid rgba(243, 156, 18, 0.3);
        }

        .import-info {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--primary);
            border: 1px solid rgba(52, 152, 219, 0.3);
        }

        .import-template {
            margin-top: 10px;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 8px;
            font-size: 0.85rem;
        }

        .import-template ul {
            margin: 10px 0;
            padding-right: 20px;
        }

        .import-template li {
            margin-bottom: 5px;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ */
        .contacts-import-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .contacts-import-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }

        .contacts-import-actions button {
            width: 100%;
        }

        .contacts-preview {
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            background-color: #f9f9f9;
        }

        .contacts-preview table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .contacts-preview th, .contacts-preview td {
            padding: 8px;
            text-align: right;
            border-bottom: 1px solid #e0e0e0;
        }

        .contacts-preview th {
            background-color: #f0f0f0;
            font-weight: 600;
        }

        .contact-checkbox {
            width: 20px;
            height: 20px;
        }

        .contacts-selection {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .contacts-selection-actions {
            display: flex;
            gap: 5px;
        }

        .contacts-selection-actions button {
            padding: 5px 10px;
            font-size: 0.8rem;
            width: auto;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ù…Ø­Ø³Ù†Ø© Ù„ØµÙØ­Ø© Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† */
        .employee-report-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .employee-report-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }

        .employee-report-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 15px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .employee-report-body {
            padding: 20px;
        }

        .report-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        .report-info-item {
            display: flex;
            flex-direction: column;
        }

        .report-info-label {
            font-weight: 600;
            color: #555;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .report-info-value {
            color: var(--primary);
            font-size: 1.1rem;
            font-weight: bold;
        }

        .daily-report-table {
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            background: white;
        }

        .daily-report-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .daily-report-table th {
            background-color: var(--primary);
            color: white;
            font-weight: 600;
            padding: 12px;
            text-align: center;
            border: 1px solid #2980b9;
        }

        .daily-report-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .daily-report-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .daily-report-table tr:hover {
            background-color: #e8f4f8;
        }

        .day-name {
            font-weight: 600;
            color: var(--secondary);
        }

        .salary-summary {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            padding: 25px;
            margin-top: 25px;
            border: 2px solid var(--primary);
        }

        .salary-summary h4 {
            color: var(--secondary);
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.2rem;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        .salary-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .breakdown-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
            border-right: 5px solid var(--primary);
            transition: transform 0.2s;
        }

        .breakdown-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 12px rgba(0,0,0,0.12);
        }

        .breakdown-label {
            font-weight: 600;
            color: #666;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .breakdown-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .breakdown-value.positive {
            color: var(--success);
        }

        .breakdown-value.negative {
            color: var(--danger);
        }

        .net-salary {
            text-align: center;
            padding: 25px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-radius: 12px;
            margin-top: 20px;
        }

        .net-salary h3 {
            margin: 0;
            font-size: 2rem;
            font-weight: bold;
        }
        
        /* ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
        .date-range-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .date-range-filter .form-group {
            flex: 1;
            min-width: 150px;
            margin-bottom: 0;
        }
        
        .date-filter-actions {
            display: flex;
            gap: 5px;
            align-items: flex-end;
        }
        
        .date-filter-actions button {
            width: auto;
            padding: 10px 15px;
            height: 46px;
        }
        
        /* Ø²Ø± ØªØµØ¯ÙŠØ± ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª */
        .export-report-btn {
            width: auto;
            padding: 8px 15px;
            font-size: 0.9rem;
            margin-left: 10px;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„ØµÙØ­Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª */
        .report-controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
            margin-bottom: 20px;
        }

        .report-controls .form-group {
            margin-bottom: 15px;
        }

        .generate-report-btn {
            background: var(--success);
            font-size: 1.1rem;
            padding: 15px;
            margin-top: 10px;
        }

        .generate-report-btn i {
            margin-left: 10px;
        }

        .report-container {
            background: white;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            margin-top: 20px;
        }

        .report-header {
            background: var(--secondary);
            color: white;
            padding: 15px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .report-header h3 {
            margin: 0;
            font-size: 1.2rem;
        }

        .report-actions {
            display: flex;
            gap: 10px;
        }

        .report-actions button {
            width: auto;
            padding: 8px 15px;
            font-size: 0.9rem;
        }

        .summary-badge {
            background: white;
            color: var(--secondary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .attendance-stats {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .attendance-stat {
            flex: 1;
            min-width: 120px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .attendance-stat.present {
            border-top: 3px solid var(--success);
        }

        .attendance-stat.absent {
            border-top: 3px solid var(--danger);
        }

        .attendance-stat.leave {
            border-top: 3px solid var(--warning);
        }

        .attendance-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 5px 0;
        }

        .attendance-stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…Ø­Ø·Ø§Øª ÙˆØ§Ù„Ø£Ø¹Ø·Ø§Ù„ */
        .station-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--primary);
        }

        .station-type {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            background-color: #f0f0f0;
            color: #555;
            margin-left: 5px;
        }

        .filter-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
        }

        .filter-section h4 {
            margin-bottom: 10px;
            color: var(--secondary);
        }

        .filter-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: flex-end;
        }

        .filter-row .form-group {
            flex: 1;
            min-width: 150px;
            margin-bottom: 0;
        }

        .filter-actions {
            display: flex;
            gap: 5px;
            min-width: 100px;
        }

        .filter-actions button {
            width: auto;
            padding: 10px 15px;
            height: 46px;
        }

        .fault-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .fault-fixed {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success);
        }

        .fault-in-progress {
            background-color: rgba(243, 156, 18, 0.1);
            color: var(--warning);
        }

        .fault-pending {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger);
        }
        
        .retry-button {
            background: var(--warning);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 10px;
            width: auto;
        }
        
        .retry-button:hover {
            background: #e67e22;
        }
        
        .loading-container {
            text-align: center;
            padding: 20px;
        }
        
        .error-container {
            text-align: center;
            padding: 20px;
            color: var(--danger);
        }
    </style>
    
    <!-- ØªØ³Ø¬ÙŠÙ„ service worker -->
    <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ service worker Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø­Ø¯Ø¯
        navigator.serviceWorker.register('https://yasminnmain44-design.github.io/Management/service-worker.js')
          .then(function(registration) {
            console.log('ServiceWorker registered successfully with scope: ', registration.scope);
          })
          .catch(function(error) {
            console.log('ServiceWorker registration failed: ', error);
            // Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŒ Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ service worker Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
            registerDynamicServiceWorker();
          });
      });
    }
    
    function registerDynamicServiceWorker() {
      const swCode = `
        const CACHE_NAME = 'attendance-cache-v1';
        const urlsToCache = [
          'https://yasminnmain44-design.github.io/Management/',
          'https://yasminnmain44-design.github.io/Management/index.html',
          'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css',
          'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js',
          'https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js',
          'https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js'
        ];

        self.addEventListener('install', function(event) {
          event.waitUntil(
            caches.open(CACHE_NAME)
              .then(function(cache) {
                console.log('Opened cache');
                return cache.addAll(urlsToCache);
              })
          );
        });

        self.addEventListener('fetch', function(event) {
          event.respondWith(
            caches.match(event.request)
              .then(function(response) {
                if (response) {
                  return response;
                }
                return fetch(event.request);
              })
          );
        });
      `;
      
      const blob = new Blob([swCode], { type: 'application/javascript' });
      const url = URL.createObjectURL(blob);
      
      navigator.serviceWorker.register(url).then(function(registration) {
        console.log('Dynamic ServiceWorker registered successfully');
      }).catch(function(error) {
        console.log('Dynamic ServiceWorker registration failed: ', error);
      });
    }
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Ù‡ÙŠØ¯Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
        <header class="app-header">
            <div class="header-top">
                <div class="app-title" id="pageTitle">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
                <div class="header-actions">
                    <button class="header-action-btn" id="exportBtn">
                        <i class="fas fa-file-export"></i>
                    </button>
                    <button class="header-action-btn" id="menuBtn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Ù…Ø¤Ø´Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ -->
        <div id="connectionStatus" class="connection-status connection-online">
            <i class="fas fa-wifi"></i> Ù…ØªØµÙ„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©
        </div>

        <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
        <div class="side-menu" id="sideMenu">
            <div class="side-menu-header">
                <div class="side-menu-title">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
                <button class="close-menu" id="closeMenu">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <ul class="menu-items">
                <li class="menu-item">
                    <a href="#" class="menu-link active" data-target="dashboard">
                        <i class="fas fa-home"></i>
                        <span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="employees">
                        <i class="fas fa-users"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="employee-database">
                        <i class="fas fa-address-book"></i>
                        <span>Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="attendance">
                        <i class="fas fa-calendar-check"></i>
                        <span>Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="leaves">
                        <i class="fas fa-umbrella-beach"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="employee-records">
                        <i class="fas fa-user-circle"></i>
                        <span>Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="financial">
                        <i class="fas fa-hand-holding-usd"></i>
                        <span>Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="reports">
                        <i class="fas fa-chart-bar"></i>
                        <span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="cash">
                        <i class="fas fa-wallet"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‡Ø¯Ø©</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="faults">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Ø³Ø¬Ù„ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="stations">
                        <i class="fas fa-building"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø·Ø§Øª</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="supervisors">
                        <i class="fas fa-user-tie"></i>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="settings">
                        <i class="fas fa-cog"></i>
                        <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-target="backup">
                        <i class="fas fa-database"></i>
                        <span>Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ¹ØªÙŠÙ… -->
        <div class="overlay" id="overlay"></div>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <main class="main-content">
            <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
            <div id="dashboard" class="tab-content active">
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</div>
                        <div class="stat-value" id="totalEmployees">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…</div>
                        <div class="stat-value" id="todayAttendance">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª</div>
                        <div class="stat-value" id="totalStations">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</div>
                        <div class="stat-value" id="monthlyLeaves">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù„Ù</div>
                        <div class="stat-value" id="totalLoans">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ù†Ø´Ø·Ø©</div>
                        <div class="stat-value" id="activeFaults">0</div>
                    </div>
                </div>

                <div class="quick-actions">
                    <div class="quick-action" data-target="attendance">
                        <i class="fas fa-user-check"></i>
                        <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±</span>
                    </div>
                    <div class="quick-action" data-target="employees">
                        <i class="fas fa-user-plus"></i>
                        <span>Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù</span>
                    </div>
                    <div class="quick-action" data-target="faults">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>ØªØ³Ø¬ÙŠÙ„ Ø¹Ø·Ù„</span>
                    </div>
                    <div class="quick-action" data-target="financial">
                        <i class="fas fa-hand-holding-usd"></i>
                        <span>Ø³Ù„ÙØ©/Ù…ÙƒØ§ÙØ£Ø©</span>
                    </div>
                    <div class="quick-action" data-target="stations">
                        <i class="fas fa-building"></i>
                        <span>Ø§Ù„Ù…Ø­Ø·Ø§Øª</span>
                    </div>
                    <div class="quick-action" data-target="cash">
                        <i class="fas fa-wallet"></i>
                        <span>Ø§Ù„Ø¹Ù‡Ø¯Ø©</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø·Ø©
                        <span class="see-all" data-target="attendance">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</span>
                    </div>
                    <div class="card-body">
                        <div class="filter-section">
                            <h4>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø¶ÙˆØ±</h4>
                            <div class="form-group">
                                <select id="dashboardStationFilter">
                                    <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø·Ø§Øª</option>
                                </select>
                            </div>
                        </div>
                        <div id="todayAttendanceList" class="empty-state">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø­Ø¶ÙˆØ± Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
            <div id="employees" class="tab-content">
                <div class="card">
                    <div class="card-header" id="employeeFormHeader">
                        Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯
                        <button class="btn-secondary" id="showAddForm" style="padding: 8px 12px; width: auto;">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
                    </div>
                    <div class="card-body">
                        <form id="employeeForm" class="hidden">
                            <div class="form-group">
                                <label for="empName">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                <input type="text" id="empName" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù">
                                <div class="validation-error" id="empNameError">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹</div>
                            </div>
                            <div class="form-group">
                                <label for="empPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                                <input type="text" id="empPhone" required placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                                <div class="validation-error" id="empPhoneError">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹</div>
                            </div>
                            <div class="form-group">
                                <label for="empJob">Ø§Ù„ÙˆØ¸ÙŠÙØ©</label>
                                <input type="text" id="empJob" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙˆØ¸ÙŠÙØ©">
                            </div>
                            <div class="form-group">
                                <label for="empSalary">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ)</label>
                                <input type="number" id="empSalary" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§ØªØ¨">
                            </div>
                            <div class="form-group">
                                <label for="empWorkDays">Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§ (ÙŠÙˆÙ…)</label>
                                <input type="number" id="empWorkDays" value="24" required>
                            </div>
                            <div class="form-group">
                                <label for="empActive">Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                <select id="empActive" required>
                                    <option value="true">ÙØ¹Ø§Ù„</option>
                                    <option value="false">ØºÙŠØ± ÙØ¹Ø§Ù„</option>
                                </select>
                            </div>
                            <button type="submit" class="btn-success">
                                <span id="employeeSubmitText">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù</span>
                            </button>
                        </form>
                        <div id="employeeFormMessage" class="empty-state">
                            ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø£ÙˆÙ„Ø§Ù‹ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØªÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
                        </div>
                        
                        <!-- Ù‚Ø³Ù… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                        <div class="import-section">
                            <h3>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                            <p>ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ù… ÙƒÙ…ÙˆØ¸ÙÙŠÙ† Ù†Ø´Ø·ÙŠÙ†.</p>
                            
                            <div class="form-group">
                                <label for="selectMultipleEmployees">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù„Ù„Ø¥Ø¶Ø§ÙØ©</label>
                                <select id="selectMultipleEmployees" multiple style="height: 150px;">
                                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="defaultJob">Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</label>
                                <input type="text" id="defaultJob" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†">
                            </div>
                            
                            <div class="form-group">
                                <label for="defaultSalary">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ)</label>
                                <input type="number" id="defaultSalary" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ">
                            </div>
                            
                            <div class="form-group">
                                <label for="defaultWorkDays">Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (ÙŠÙˆÙ…)</label>
                                <input type="number" id="defaultWorkDays" value="24">
                            </div>
                            
                            <button class="btn-success" id="importFromDatabaseBtn">
                                <i class="fas fa-user-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…Ø­Ø¯Ø¯ÙŠÙ†
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                        <button class="btn-secondary" id="exportEmployees" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div id="employeesList" class="empty-state">
                            Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
            <div id="employee-database" class="tab-content">
                <div class="card add-employee-db">
                    <div class="card-header">Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯ Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                    <div class="card-body">
                        <form id="employeeDatabaseForm">
                            <div class="form-group">
                                <label for="dbEmpName">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                <input type="text" id="dbEmpName" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù">
                                <div class="validation-error" id="dbEmpNameError">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹</div>
                            </div>
                            <div class="form-group">
                                <label for="dbEmpPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                                <input type="text" id="dbEmpPhone" required placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                                <div class="validation-error" id="dbEmpPhoneError">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹</div>
                            </div>
                            <div class="form-group">
                                <label for="dbEmpWhatsapp">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</label>
                                <input type="text" id="dbEmpWhatsapp" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                            </div>
                            <div class="form-group">
                                <label for="dbEmpAddress">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                                <textarea id="dbEmpAddress" rows="2" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ¸Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"></textarea>
                            </div>
                            <button type="submit" class="btn-success">
                                <span id="employeeDbSubmitText">Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
                            </button>
                        </form>

                        <!-- Ù‚Ø³Ù… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ù† Ø§Ù„Ù‡Ø§ØªÙ -->
                        <div class="contacts-import-section">
                            <h3>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ù† Ø§Ù„Ù‡Ø§ØªÙ</h3>
                            <p>ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ù† Ù‡Ø§ØªÙÙƒ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„ØªÙˆÙÙŠØ± Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø¬Ù‡Ø¯.</p>
                            
                            <div class="contacts-import-actions">
                                <button class="btn-success" id="importContactsBtn">
                                    <i class="fas fa-address-book"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
                                </button>
                            </div>
                            
                            <div id="contactsPreview" class="contacts-preview" style="display: none;">
                                <div class="contacts-selection">
                                    <h4>Ø§Ø®ØªØ± Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ù„Ù„Ø¥Ø¶Ø§ÙØ©</h4>
                                    <div class="contacts-selection-actions">
                                        <button class="btn-secondary" id="selectAllContacts">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„</button>
                                        <button class="btn-secondary" id="deselectAllContacts">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ¯</button>
                                    </div>
                                </div>
                                <table id="contactsPreviewTable">
                                    <thead>
                                        <tr>
                                            <th>ØªØ­Ø¯ÙŠØ¯</th>
                                            <th>Ø§Ù„Ø§Ø³Ù…</th>
                                            <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
                                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                                    </tbody>
                                </table>
                                
                                <div class="contacts-import-actions" style="margin-top: 15px;">
                                    <button class="btn-success" id="addSelectedContactsBtn">
                                        <i class="fas fa-user-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Ù‚Ø³Ù… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† Ù…Ù„Ù Excel Ø£Ùˆ CSV -->
                        <div class="import-section">
                            <h3>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† Ù…Ù„Ù Excel Ø£Ùˆ CSV</h3>
                            <p>ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† Ù…Ù„Ù Excel Ø£Ùˆ CSV Ù„ØªÙˆÙÙŠØ± Ø§Ù„ÙˆÙ‚Øª.</p>
                            
                            <div class="import-template">
                                <strong>Ù†Ù…ÙˆØ°Ø¬ Ù…Ù„Ù Excel/CSV Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</strong>
                                <ul>
                                    <li>ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù…Ù„Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨:</li>
                                    <li>Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„: Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù (Ù…Ø·Ù„ÙˆØ¨)</li>
                                    <li>Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ù…Ø·Ù„ÙˆØ¨)</li>
                                    <li>Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù„Ø«: Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</li>
                                    <li>Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø±Ø§Ø¨Ø¹: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</li>
                                </ul>
                                <button class="btn-secondary" id="downloadTemplateBtn" style="padding: 8px 12px; width: auto;">
                                    <i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                                </button>
                            </div>
                            
                            <div class="form-group">
                                <label for="importFile">Ø§Ø®ØªØ± Ù…Ù„Ù Excel Ø£Ùˆ CSV</label>
                                <input type="file" id="importFile" accept=".xlsx, .xls, .csv">
                            </div>
                            
                            <div class="import-actions">
                                <button class="btn-warning" id="previewImportBtn">
                                    <i class="fas fa-eye"></i> Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                                </button>
                                <button class="btn-success" id="importEmployeesBtn">
                                    <i class="fas fa-upload"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                                </button>
                            </div>
                            
                            <div id="importPreview" class="import-preview" style="display: none;">
                                <h4>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©</h4>
                                <table id="previewTable">
                                    <thead>
                                        <tr>
                                            <th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
                                            <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
                                            <th>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</th>
                                            <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <div id="importStatus" class="import-status" style="display: none;">
                                <!-- Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‡Ù†Ø§ -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                        <button class="btn-secondary" id="exportEmployeeDatabase" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <input type="text" id="searchEmployee" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØ¸Ù Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ...">
                        </div>
                        <div id="employeeDatabaseList" class="empty-state">
                            Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ -->
            <div id="attendance" class="tab-content">
                <div class="card">
                    <div class="card-header">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</div>
                    <div class="card-body">
                        <div class="form-group">
                            <button class="btn-success" id="autoAttendanceBtn">
                                <span id="autoAttendanceText">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
                            </button>
                        </div>
                        <form id="manualAttendanceForm">
                            <div class="form-group">
                                <label for="attendanceEmployee">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                <select id="attendanceEmployee" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="attendanceStation">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                <select id="attendanceStation" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="attendanceSupervisor">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„</label>
                                <select id="attendanceSupervisor" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="attendanceDate">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                                <input type="date" id="attendanceDate" required>
                            </div>
                            <div class="form-group">
                                <label for="attendanceStatus">Ø§Ù„Ø­Ø§Ù„Ø©</label>
                                <select id="attendanceStatus" required>
                                    <option value="Ø­Ø§Ø¶Ø±">Ø­Ø§Ø¶Ø± (Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù…Ø­Ø·Ø©)</option>
                                    <option value="ØºØ§Ø¦Ø¨">ØºØ§Ø¦Ø¨ (ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù…Ø­Ø·Ø©)</option>
                                    <option value="Ø¥Ø¬Ø§Ø²Ø©">Ø¥Ø¬Ø§Ø²Ø©</option>
                                </select>
                            </div>
                            <button type="submit" class="btn-success">
                                <span id="attendanceSubmitText">ØªØ³Ø¬ÙŠÙ„</span>
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨
                        <button class="btn-secondary" id="exportAttendance" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div class="filter-section">
                            <h4>ÙÙ„ØªØ±Ø© Ø§Ù„Ø³Ø¬Ù„</h4>
                            <div class="filter-row">
                                <div class="form-group">
                                    <label for="filterAttendanceMonth">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±</label>
                                    <input type="month" id="filterAttendanceMonth">
                                </div>
                                <div class="form-group">
                                    <label for="filterAttendanceStation">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                    <select id="filterAttendanceStation">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø·Ø§Øª</option>
                                    </select>
                                </div>
                                <div class="filter-actions">
                                    <button class="btn-success" id="applyAttendanceFilter">
                                        <i class="fas fa-filter"></i> ØªØ·Ø¨ÙŠÙ‚
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="attendanceList" class="empty-state">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø­Ø¶ÙˆØ±
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª -->
            <div id="leaves" class="tab-content">
                <div class="card">
                    <div class="card-header">ØªØ³Ø¬ÙŠÙ„ Ø¥Ø¬Ø§Ø²Ø©</div>
                    <div class="card-body">
                        <form id="leaveForm">
                            <div class="form-group">
                                <label for="leaveEmployee">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                <select id="leaveEmployee" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="leaveStation">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                <select id="leaveStation" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="leaveSupervisor">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„</label>
                                <select id="leaveSupervisor" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="leaveType">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</label>
                                <select id="leaveType" required>
                                    <option value="Ø³Ù†ÙˆÙŠØ©">Ø³Ù†ÙˆÙŠØ©</option>
                                    <option value="Ù…Ø±Ø¶ÙŠØ©">Ù…Ø±Ø¶ÙŠØ©</option>
                                    <option value="Ø·Ø§Ø±Ø¦Ø©">Ø·Ø§Ø±Ø¦Ø©</option>
                                    <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="leaveStart">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</label>
                                <input type="date" id="leaveStart" required>
                            </div>
                            <div class="form-group">
                                <label for="leaveEnd">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</label>
                                <input type="date" id="leaveEnd" required>
                            </div>
                            <div class="form-group">
                                <label for="leaveNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                                <textarea id="leaveNotes" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©"></textarea>
                            </div>
                            <button type="submit" class="btn-success">
                                <span id="leaveSubmitText">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</span>
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
                        <button class="btn-secondary" id="exportLeaves" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div class="filter-section">
                            <h4>ÙÙ„ØªØ±Ø© Ø§Ù„Ø³Ø¬Ù„</h4>
                            <div class="filter-row">
                                <div class="form-group">
                                    <label for="leaveFilterStartDate">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                                    <input type="date" id="leaveFilterStartDate">
                                </div>
                                <div class="form-group">
                                    <label for="leaveFilterEndDate">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                                    <input type="date" id="leaveFilterEndDate">
                                </div>
                                <div class="form-group">
                                    <label for="filterLeaveStation">Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                    <select id="filterLeaveStation">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø·Ø§Øª</option>
                                    </select>
                                </div>
                            </div>
                            <div class="date-filter-actions">
                                <button class="btn-success" id="applyLeaveFilter">
                                    <i class="fas fa-filter"></i> ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±
                                </button>
                                <button class="btn-secondary" id="resetLeaveFilter">
                                    <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                                </button>
                            </div>
                        </div>
                        <div id="leavesList" class="empty-state">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø²Ø§Øª Ù…Ø³Ø¬Ù„Ø©
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
            <div id="employee-records" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-file-alt"></i> Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø´Ù‡Ø±ÙŠ
                    </div>
                    <div class="card-body">
                        <div class="report-controls">
                            <div class="form-group">
                                <label for="selectEmployeeForReport">
                                    <i class="fas fa-user"></i> Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù
                                </label>
                                <select id="selectEmployeeForReport" required>
                                    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù --</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="selectMonthForReport">
                                    <i class="fas fa-calendar-alt"></i> Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±
                                </label>
                                <input type="month" id="selectMonthForReport" required>
                            </div>
                            
                            <button id="generateEmployeeReportBtn" class="btn-success generate-report-btn">
                                <i class="fas fa-chart-line"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="employeeReportContainer" style="display: none;">
                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù‡Ù†Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                </div>
            </div>

            <!-- Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª -->
            <div id="financial" class="tab-content">
                <div class="card">
                    <div class="card-header">Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª ÙˆØ§Ù„Ø®ØµÙˆÙ…Ø§Øª</div>
                    <div class="card-body">
                        <form id="financialForm">
                            <div class="form-group">
                                <label for="financialEmployee">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</label>
                                <select id="financialEmployee" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="financialStation">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                <select id="financialStation" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="financialSupervisor">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„</label>
                                <select id="financialSupervisor" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="financialType">Ø§Ù„Ù†ÙˆØ¹</label>
                                <select id="financialType" required>
                                    <option value="Ø³Ù„ÙØ©">Ø³Ù„ÙØ©</option>
                                    <option value="Ù…ÙƒØ§ÙØ£Ø©">Ù…ÙƒØ§ÙØ£Ø©</option>
                                    <option value="Ø®ØµÙ…">Ø®ØµÙ…</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="financialAmount">Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ)</label>
                                <input type="number" id="financialAmount" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº">
                            </div>
                            <div class="form-group">
                                <label for="financialDate">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                                <input type="date" id="financialDate" required>
                            </div>
                            <div class="form-group">
                                <label for="financialNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                                <textarea id="financialNotes" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©"></textarea>
                            </div>
                            <button type="submit" class="btn-success">
                                <span id="financialSubmitText">ØªØ³Ø¬ÙŠÙ„</span>
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ø³Ø¬Ù„ Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª ÙˆØ§Ù„Ø®ØµÙˆÙ…Ø§Øª
                        <button class="btn-secondary" id="exportFinancials" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div class="filter-section">
                            <h4>ÙÙ„ØªØ±Ø© Ø§Ù„Ø³Ø¬Ù„</h4>
                            <div class="filter-row">
                                <div class="form-group">
                                    <label for="filterFinancialMonth">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±</label>
                                    <input type="month" id="filterFinancialMonth">
                                </div>
                                <div class="form-group">
                                    <label for="filterFinancialStation">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                    <select id="filterFinancialStation">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø·Ø§Øª</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filterFinancialType">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©</label>
                                    <select id="filterFinancialType">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø±ÙƒØ§Øª</option>
                                        <option value="Ø³Ù„ÙØ©">Ø³Ù„ÙØ©</option>
                                        <option value="Ù…ÙƒØ§ÙØ£Ø©">Ù…ÙƒØ§ÙØ£Ø©</option>
                                        <option value="Ø®ØµÙ…">Ø®ØµÙ…</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div id="financialList" class="empty-state">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª Ù…Ø§Ù„ÙŠØ© Ù…Ø³Ø¬Ù„Ø©
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
            <div id="reports" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª
                        <button class="btn-secondary" id="exportReport" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="reportMonth">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±</label>
                            <input type="month" id="reportMonth">
                            <button id="generateReport" class="btn-success" style="margin-top: 10px;">
                                <span id="generateReportText">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</span>
                            </button>
                        </div>

                        <div class="table-container">
                            <table id="salaryReportTable">
                                <thead>
                                    <tr>
                                        <th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
                                        <th>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</th>
                                        <th>Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„</th>
                                        <th>ØµØ§ÙÙŠ Ø§Ù„Ù…Ø±ØªØ¨</th>
                                        <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‡Ø¯Ø© -->
            <div id="cash" class="tab-content">
                <div class="card">
                    <div class="card-header">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‡Ø¯Ø©</div>
                    <div class="card-body">
                        <div class="cash-summary">
                            <div class="cash-summary-item">
                                <div class="cash-summary-label">Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ù‡Ø¯Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
                                <div class="cash-summary-value" id="currentCashBalance">0 Ø¬.Ù…</div>
                            </div>
                            <div class="cash-summary-item">
                                <div class="cash-summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª</div>
                                <div class="cash-summary-value" id="totalDeposits">0 Ø¬.Ù…</div>
                            </div>
                            <div class="cash-summary-item">
                                <div class="cash-summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµØ±ÙÙŠØ§Øª</div>
                                <div class="cash-summary-value" id="totalWithdrawals">0 Ø¬.Ù…</div>
                            </div>
                        </div>

                        <div class="cash-tabs">
                            <div class="cash-tab active" data-tab="deposit">Ø¥ÙŠØ¯Ø§Ø¹</div>
                            <div class="cash-tab" data-tab="withdrawal">ØµØ±Ù</div>
                        </div>

                        <div id="deposit" class="cash-tab-content active">
                            <form id="depositForm">
                                <div class="form-group">
                                    <label for="depositAmount">Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ)</label>
                                    <input type="number" id="depositAmount" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº">
                                    <div class="validation-error" id="depositAmountError">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­</div>
                                </div>
                                <div class="form-group">
                                    <label for="depositSupervisor">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„</label>
                                    <select id="depositSupervisor" required>
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="depositDate">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                                    <input type="date" id="depositDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="depositCategory">ÙØ¦Ø© Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹</label>
                                    <select id="depositCategory" required>
                                        <option value="Ø¥ÙŠØ±Ø§Ø¯Ø§Øª">Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</option>
                                        <option value="Ø³Ø¯Ø§Ø¯ Ø³Ù„Ù">Ø³Ø¯Ø§Ø¯ Ø³Ù„Ù</option>
                                        <option value="ØªØ­ÙˆÙŠÙ„ Ù…Ù† Ø¨Ù†Ùƒ">ØªØ­ÙˆÙŠÙ„ Ù…Ù† Ø¨Ù†Ùƒ</option>
                                        <option value="Ø¥ÙŠØ¯Ø§Ø¹ Ø´Ø®ØµÙŠ">Ø¥ÙŠØ¯Ø§Ø¹ Ø´Ø®ØµÙŠ</option>
                                        <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="depositNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                                    <textarea id="depositNotes" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹"></textarea>
                                </div>
                                <button type="submit" class="btn-success">
                                    <span id="depositSubmitText">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹</span>
                                </button>
                            </form>
                        </div>

                        <div id="withdrawal" class="cash-tab-content">
                            <form id="withdrawalForm">
                                <div class="form-group">
                                    <label for="withdrawalAmount">Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ)</label>
                                    <input type="number" id="withdrawalAmount" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº">
                                    <div class="validation-error" id="withdrawalAmountError">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­</div>
                                </div>
                                <div class="form-group">
                                    <label for="withdrawalSupervisor">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„</label>
                                    <select id="withdrawalSupervisor" required>
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="withdrawalType">Ù†ÙˆØ¹ Ø§Ù„ØµØ±Ù</label>
                                    <select id="withdrawalType" required>
                                        <option value="Ù…ØµØ±ÙˆÙØ§Øª ØªØ´ØºÙŠÙ„">Ù…ØµØ±ÙˆÙØ§Øª ØªØ´ØºÙŠÙ„</option>
                                        <option value="Ù…ØµØ±ÙˆÙØ§Øª ØµÙŠØ§Ù†Ø©">Ù…ØµØ±ÙˆÙØ§Øª ØµÙŠØ§Ù†Ø©</option>
                                        <option value="Ù…Ø´ØªØ±ÙŠØ§Øª">Ù…Ø´ØªØ±ÙŠØ§Øª</option>
                                        <option value="Ø±ÙˆØ§ØªØ¨">Ø±ÙˆØ§ØªØ¨</option>
                                        <option value="Ø³Ù„Ù Ù…ÙˆØ¸ÙÙŠÙ†">Ø³Ù„Ù Ù…ÙˆØ¸ÙÙŠÙ†</option>
                                        <option value="ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø¨Ù†Ùƒ">ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø¨Ù†Ùƒ</option>
                                        <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="withdrawalDate">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                                    <input type="date" id="withdrawalDate" required>
                                </div>
                                <div class="form-group">
                                    <label for="withdrawalRecipient">Ø§Ù„Ù…Ø³ØªÙ„Ù…</label>
                                    <input type="text" id="withdrawalRecipient" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                                </div>
                                <div class="form-group">
                                    <label for="withdrawalNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                                    <textarea id="withdrawalNotes" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ Ø§Ù„ØµØ±Ù"></textarea>
                                </div>
                                <button type="submit" class="btn-warning">
                                    <span id="withdrawalSubmitText">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµØ±Ù</span>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ø³Ø¬Ù„ Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¹Ù‡Ø¯Ø©
                        <button class="btn-secondary" id="exportCash" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="filterCashMonth">Ø§Ø®ØªØ± Ø§Ù„Ø´Ù‡Ø±</label>
                            <input type="month" id="filterCashMonth">
                        </div>
                        <div class="form-group">
                            <label for="filterCashType">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©</label>
                            <select id="filterCashType">
                                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø±ÙƒØ§Øª</option>
                                <option value="deposit">Ø¥ÙŠØ¯Ø§Ø¹</option>
                                <option value="withdrawal">ØµØ±Ù</option>
                            </select>
                        </div>
                        <div id="cashList" class="empty-state">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª Ù„Ù„Ø¹Ù‡Ø¯Ø©
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø³Ø¬Ù„ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ -->
            <div id="faults" class="tab-content">
                <div class="card">
                    <div class="card-header">ØªØ³Ø¬ÙŠÙ„ Ø¹Ø·Ù„ Ø¬Ø¯ÙŠØ¯</div>
                    <div class="card-body">
                        <form id="faultForm">
                            <div class="form-group">
                                <label for="faultStation">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                <select id="faultStation" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="faultSupervisor">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„</label>
                                <select id="faultSupervisor" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="faultTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø·Ù„</label>
                                <input type="text" id="faultTitle" required placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø·Ù„">
                            </div>
                            <div class="form-group">
                                <label for="faultDescription">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„</label>
                                <textarea id="faultDescription" rows="4" required placeholder="Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="faultDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø·Ù„</label>
                                <input type="date" id="faultDate" required>
                            </div>
                            <div class="form-group">
                                <label for="faultStatus">Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø·Ù„</label>
                                <select id="faultStatus" required>
                                    <option value="pending">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­</option>
                                    <option value="in-progress">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥ØµÙ„Ø§Ø­</option>
                                    <option value="fixed">ØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­</option>
                                </select>
                            </div>
                            <button type="submit" class="btn-success">
                                <span id="faultSubmitText">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„</span>
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ø³Ø¬Ù„ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„
                        <button class="btn-secondary" id="exportFaults" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div class="filter-section">
                            <h4>ÙÙ„ØªØ±Ø© Ø§Ù„Ø£Ø¹Ø·Ø§Ù„</h4>
                            <div class="filter-row">
                                <div class="form-group">
                                    <label for="filterFaultStation">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                    <select id="filterFaultStation">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø·Ø§Øª</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="filterFaultStatus">Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø·Ù„</label>
                                    <select id="filterFaultStatus">
                                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                                        <option value="pending">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­</option>
                                        <option value="in-progress">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥ØµÙ„Ø§Ø­</option>
                                        <option value="fixed">ØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-row" style="margin-top: 10px;">
                                <div class="form-group">
                                    <label for="filterFaultStartDate">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                                    <input type="date" id="filterFaultStartDate">
                                </div>
                                <div class="form-group">
                                    <label for="filterFaultEndDate">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                                    <input type="date" id="filterFaultEndDate">
                                </div>
                                <div class="filter-actions">
                                    <button class="btn-success" id="applyFaultFilter">
                                        <i class="fas fa-filter"></i> ØªØ·Ø¨ÙŠÙ‚
                                    </button>
                                    <button class="btn-secondary" id="resetFaultFilter">
                                        <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="faultsList" class="empty-state">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¹Ø·Ø§Ù„ Ù…Ø³Ø¬Ù„Ø©
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø·Ø§Øª -->
            <div id="stations" class="tab-content">
                <div class="card">
                    <div class="card-header">Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©</div>
                    <div class="card-body">
                        <form id="stationForm">
                            <div class="form-group">
                                <label for="stationName">Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                <input type="text" id="stationName" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø·Ø©">
                            </div>
                            <div class="form-group">
                                <label for="stationType">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­Ø·Ø©</label>
                                <select id="stationType" required>
                                    <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­Ø·Ø©</option>
                                    <option value="ØµØ±Ù">ØµØ±Ù ØµØ­ÙŠ</option>
                                    <option value="Ù…ÙŠØ§Ù‡">Ù…ÙŠØ§Ù‡</option>
                                    <option value="Ø±ÙØ¹">Ø±ÙØ¹ ØµØ±Ù ØµØ­ÙŠ</option>
                                    <option value="Ù…Ø¹Ø§Ù„Ø¬Ø©">Ù…Ø¹Ø§Ù„Ø¬Ø©</option>
                                    <option value="Ù…Ø­Ø·Ø© ØªØ­Ù„ÙŠØ©">Ù…Ø­Ø·Ø© ØªØ­Ù„ÙŠØ©</option>
                                    <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="stationGovernorate">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label>
                                <select id="stationGovernorate" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
                                    <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
                                    <option value="Ø§Ù„Ø¬ÙŠØ²Ø©">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
                                    <option value="Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©">Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
                                    <option value="Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©">Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©</option>
                                    <option value="Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
                                    <option value="Ø§Ù„ØºØ±Ø¨ÙŠØ©">Ø§Ù„ØºØ±Ø¨ÙŠØ©</option>
                                    <option value="Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©">Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©</option>
                                    <option value="Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©">Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©</option>
                                    <option value="Ø§Ù„Ø¨Ø­ÙŠØ±Ø©">Ø§Ù„Ø¨Ø­ÙŠØ±Ø©</option>
                                    <option value="ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®">ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®</option>
                                    <option value="Ø¯Ù…ÙŠØ§Ø·">Ø¯Ù…ÙŠØ§Ø·</option>
                                    <option value="Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯">Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯</option>
                                    <option value="Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©">Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©</option>
                                    <option value="Ø§Ù„Ø³ÙˆÙŠØ³">Ø§Ù„Ø³ÙˆÙŠØ³</option>
                                    <option value="Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡">Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡</option>
                                    <option value="Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡">Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡</option>
                                    <option value="Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ">Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ</option>
                                    <option value="Ø§Ù„ÙÙŠÙˆÙ…">Ø§Ù„ÙÙŠÙˆÙ…</option>
                                    <option value="Ø§Ù„Ù…Ù†ÙŠØ§">Ø§Ù„Ù…Ù†ÙŠØ§</option>
                                    <option value="Ø£Ø³ÙŠÙˆØ·">Ø£Ø³ÙŠÙˆØ·</option>
                                    <option value="Ø³ÙˆÙ‡Ø§Ø¬">Ø³ÙˆÙ‡Ø§Ø¬</option>
                                    <option value="Ù‚Ù†Ø§">Ù‚Ù†Ø§</option>
                                    <option value="Ø§Ù„Ø£Ù‚ØµØ±">Ø§Ù„Ø£Ù‚ØµØ±</option>
                                    <option value="Ø£Ø³ÙˆØ§Ù†">Ø£Ø³ÙˆØ§Ù†</option>
                                    <option value="Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯">Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯</option>
                                    <option value="Ù…Ø·Ø±ÙˆØ­">Ù…Ø·Ø±ÙˆØ­</option>
                                    <option value="Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±">Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="stationArea">Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
                                <input type="text" id="stationArea" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø·Ù‚Ø©">
                            </div>
                            <div class="form-group">
                                <label for="stationAddress">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„</label>
                                <textarea id="stationAddress" rows="3" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„"></textarea>
                            </div>
                            <button type="submit" class="btn-success">
                                <span id="stationSubmitText">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­Ø·Ø©</span>
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø·Ø§Øª
                        <button class="btn-secondary" id="exportStations" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div id="stationsList" class="empty-state">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø·Ø§Øª Ù…Ø³Ø¬Ù„Ø©
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† -->
            <div id="supervisors" class="tab-content">
                <div class="card">
                    <div class="card-header">Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø¤ÙˆÙ„ Ø¬Ø¯ÙŠØ¯</div>
                    <div class="card-body">
                        <form id="supervisorForm">
                            <div class="form-group">
                                <label for="supervisorEmployee">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</label>
                                <select id="supervisorEmployee" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</option>
                                </select>
                            </div>
                            <!-- Ø­Ù‚Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù…Ø¹ Ø²Ø± Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙ„Ù…Ø© Ø³Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© -->
                            <div class="form-group">
                                <label for="supervisorPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" id="supervisorPassword" required placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„" style="flex: 1;">
                                    <button type="button" class="btn-secondary" id="generatePasswordBtn" style="width: auto; padding: 14px;">
                                        <i class="fas fa-key"></i> Ø¥Ù†Ø´Ø§Ø¡
                                    </button>
                                </div>
                                <div class="validation-error" id="supervisorPasswordError">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù…Ø·Ù„ÙˆØ¨Ø©</div>
                            </div>
                            <div class="form-group">
                                <label for="supervisorActive">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
                                <select id="supervisorActive" required>
                                    <option value="true">ÙØ¹Ø§Ù„</option>
                                    <option value="false">ØºÙŠØ± ÙØ¹Ø§Ù„</option>
                                </select>
                            </div>
                            <button type="submit" class="btn-success">
                                <span id="supervisorSubmitText">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</span>
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†
                        <button class="btn-secondary" id="exportSupervisors" style="padding: 8px 12px; width: auto;">ØªØµØ¯ÙŠØ± Excel</button>
                    </div>
                    <div class="card-body">
                        <div id="supervisorsList" class="empty-state">
                            Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
            <div id="settings" class="tab-content">
                <div class="card">
                    <div class="card-header">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="appName">Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</label>
                            <input type="text" id="appName" value="Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…">
                        </div>
                        
                        <div class="form-group">
                            <label for="companyName">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</label>
                            <input type="text" id="companyName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©">
                        </div>
                        
                        <div class="form-group">
                            <label for="defaultWorkDays">Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</label>
                            <input type="number" id="defaultWorkDays" value="24">
                        </div>
                        
                        <div class="form-group">
                            <label for="language">Ø§Ù„Ù„ØºØ©</label>
                            <select id="language">
                                <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        
                        <button class="btn-success" id="saveSettingsBtn">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ -->
            <div id="backup" class="tab-content">
                <div class="card">
                    <div class="card-header">Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
                    <div class="card-body">
                        <p>ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ù† Ø®Ù„Ø§Ù„ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ø³ØªØ¹Ø§Ø¯ØªÙ‡Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©.</p>
                        
                        <div class="backup-section">
                            <h3>ØªØ­Ù…ÙŠÙ„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</h3>
                            <p>Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†ØŒ Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§ØªØŒ ÙˆØ§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©ØŒ Ø§Ù„Ù…Ø­Ø·Ø§ØªØŒ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†ØŒ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„).</p>
                            <button class="btn-success" id="downloadBackupBtn">
                                <i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                            </button>
                        </div>
                        
                        <div class="backup-section">
                            <h3>Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</h3>
                            <p>Ù‚Ù… Ø¨Ø±ÙØ¹ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø³Ø§Ø¨Ù‚Ø© Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.</p>
                            <div class="form-group">
                                <label for="backupFile">Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</label>
                                <input type="file" id="backupFile" accept=".json">
                            </div>
                            <button class="btn-warning" id="restoreBackupBtn">
                                <i class="fas fa-upload"></i> Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                            </button>
                        </div>
                        
                        <div class="backup-section">
                            <h3>Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                            <p>ØªØ­Ø°ÙŠØ±: Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø³ÙŠÙ‚ÙˆÙ… Ø¨Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.</p>
                            <button class="btn-danger" id="deleteAllDataBtn">
                                <i class="fas fa-trash"></i> Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ -->
        <nav class="bottom-nav">
            <a href="#" class="nav-item" data-target="dashboard">
                <div class="nav-icon"><i class="fas fa-home"></i></div>
                <div class="nav-text">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            </a>
            <a href="#" class="nav-item" data-target="employees">
                <div class="nav-icon"><i class="fas fa-users"></i></div>
                <div class="nav-text">Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</div>
            </a>
            <a href="#" class="nav-item-attendance" data-target="attendance">
                <div class="nav-icon"><i class="fas fa-user-check"></i></div>
                <div class="nav-text">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±</div>
            </a>
            <a href="#" class="nav-item" data-target="faults">
                <div class="nav-icon"><i class="fas fa-exclamation-triangle"></i></div>
                <div class="nav-text">Ø§Ù„Ø£Ø¹Ø·Ø§Ù„</div>
            </a>
            <a href="#" class="nav-item" data-target="stations">
                <div class="nav-icon"><i class="fas fa-building"></i></div>
                <div class="nav-text">Ø§Ù„Ù…Ø­Ø·Ø§Øª</div>
            </a>
        </nav>
    </div>

    <script>
        // ØªÙ‡ÙŠØ¦Ø© Firebase Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ
        const firebaseConfig = {
            apiKey: "AIzaSyDjImFc52SF5TlN7k7vz0H6-8bWl8Pkz0k",
            authDomain: "haat-a88ee.firebaseapp.com",
            databaseURL: "https://haat-a88ee-default-rtdb.firebaseio.com",
            projectId: "haat-a88ee",
            storageBucket: "haat-a88ee.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890"
        };

        // ØªÙ‡ÙŠØ¦Ø© Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        let employees = [];
        let attendance = [];
        let leaves = [];
        let financials = [];
        let employeeDatabase = [];
        let cashTransactions = [];
        let stations = [];
        let supervisors = [];
        let faults = [];
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø§Ù„ÙŠ
        let currentReportData = null;
        
        // Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
        let isConnected = false;
        let connectionRetryCount = 0;
        const maxRetries = 3;
        
        // Ù‚Ø§Ø¦Ù…Ø© ÙƒÙ„Ù…Ø§Øª Ø¹Ø±Ø¨ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙ„Ù…Ø§Øª Ø³Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
        const arabicWords = [
            'Ù‚Ù…Ø©', 'Ø¨Ø­Ø±', 'Ù†ÙˆØ±', 'Ø³Ø­Ø±', 'Ø£Ù…Ù„', 'Ù†Ø¬Ø§Ø­', 'ØªÙ…ÙŠØ²', 'Ø§Ø¨Ø¯Ø§Ø¹', 'ØªÙÙˆÙ‚', 'Ø±ÙŠØ§Ø¯Ø©',
            'Ø³Ù…Ø§Ø¡', 'Ù‚Ù…Ø±', 'Ø´Ù…Ø³', 'ÙˆØ±Ø¯', 'Ø¹Ø·Ø±', 'Ù„Ø¤Ù„Ø¤', 'Ù…Ø±Ø¬Ø§Ù†', 'ÙŠØ§Ù‚ÙˆØª', 'Ø²Ù…Ø±Ø¯', 'ÙÙŠØ±ÙˆØ²',
            'ØµÙ‚Ø±', 'Ù†Ø³Ø±', 'Ø£Ø³Ø¯', 'Ù†Ù…Ø±', 'ÙÙ‡Ø¯', 'ØºØ²Ø§Ù„', 'ÙŠÙ…Ø§Ù…Ø©', 'Ø¨Ù„Ø¨Ù„', 'Ø¹Ù†Ø¯Ù„ÙŠØ¨', 'Ø¨ÙˆÙ…Ø©',
            'Ù†Ø®Ù„Ø©', 'Ø²ÙŠØªÙˆÙ†', 'ØªÙØ§Ø­', 'Ø¨Ø±ØªÙ‚Ø§Ù„', 'Ù„ÙŠÙ…ÙˆÙ†', 'Ù…Ø§Ù†Ø¬Ùˆ', 'Ø¹Ù†Ø¨', 'ØªÙŠÙ†', 'Ø±Ù…Ø§Ù†', 'ÙØ±Ø§ÙˆÙ„Ø©',
            'Ù…ÙƒØ©', 'Ù…Ø¯ÙŠÙ†Ø©', 'Ù‚Ø¯Ø³', 'Ø¯Ù…Ø´Ù‚', 'Ø¨ØºØ¯Ø§Ø¯', 'Ù‚Ø§Ù‡Ø±Ø©', 'Ø±ÙŠØ§Ø¶', 'Ø¬Ø¯Ø©', 'Ø¯Ø¨ÙŠ', 'Ù…Ø³Ù‚Ø·',
            'Ù†ÙŠÙ„', 'ÙØ±Ø§Øª', 'Ø¯Ø¬Ù„Ø©', 'Ø¨Ø­Ø±', 'ÙˆØ§Ø¯ÙŠ', 'Ø¬Ø¨Ù„', 'Ø³Ù‡Ù„', 'ØµØ­Ø±Ø§Ø¡', 'ÙˆØ§Ø­Ø©', 'ØºØ§Ø¨Ø©',
            'Ø°Ù‡Ø¨', 'ÙØ¶Ø©', 'Ù†Ø­Ø§Ø³', 'Ø­Ø¯ÙŠØ¯', 'Ø£Ù„Ù…Ø§Ø³', 'ÙŠØ§Ù‚ÙˆØª', 'Ø²Ø¨Ø±Ø¬Ø¯', 'Ø¹Ù‚ÙŠÙ‚', 'ÙÙŠØ±ÙˆØ²Ø¬', 'Ù„Ø§Ø²ÙˆØ±Ø¯',
            'ØµØ¨Ø±', 'Ø­ÙƒÙ…Ø©', 'Ø¹Ù„Ù…', 'Ù…Ø¹Ø±ÙØ©', 'Ø«Ù‚Ø§ÙØ©', 'ÙÙƒØ±', 'Ø±Ø£ÙŠ', 'ÙÙƒØ±Ø©', 'Ù‡Ø¯Ù', 'ØºØ§ÙŠØ©',
            'Ø³Ø¹Ø§Ø¯Ø©', 'ÙØ±Ø­', 'Ø³Ø±ÙˆØ±', 'Ø¨Ù‡Ø¬Ø©', 'Ù…Ø±Ø­', 'Ø§Ø¨ØªØ³Ø§Ù…Ø©', 'Ø¶Ø­ÙƒØ©', 'Ø¨Ø³Ù…Ø©', 'Ù‡Ù†Ø§Ø¡', 'Ø±Ø¶Ø§'
        ];

        // Ø¹Ù†Ø§ØµØ± DOM
        const sideMenu = document.getElementById('sideMenu');
        const overlay = document.getElementById('overlay');
        const menuBtn = document.getElementById('menuBtn');
        const closeMenu = document.getElementById('closeMenu');
        const exportBtn = document.getElementById('exportBtn');
        const connectionStatus = document.getElementById('connectionStatus');

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', function() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
            document.getElementById('leaveStart').value = today;
            document.getElementById('leaveEnd').value = today;
            document.getElementById('financialDate').value = today;
            document.getElementById('depositDate').value = today;
            document.getElementById('withdrawalDate').value = today;
            document.getElementById('faultDate').value = today;
            document.getElementById('selectMonthForReport').value = new Date().toISOString().slice(0, 7);
            
            // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ
            const currentMonth = new Date().toISOString().slice(0, 7);
            document.getElementById('filterAttendanceMonth').value = currentMonth;
            document.getElementById('reportMonth').value = currentMonth;
            document.getElementById('filterCashMonth').value = currentMonth;
            document.getElementById('filterFinancialMonth').value = currentMonth;
            
            // ØªØ¹ÙŠÙŠÙ† ØªØ§Ø±ÙŠØ® Ø§Ù„ÙÙ„ØªØ± Ù„Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
            document.getElementById('leaveFilterStartDate').value = today;
            document.getElementById('leaveFilterEndDate').value = today;
            document.getElementById('filterFaultStartDate').value = today;
            document.getElementById('filterFaultEndDate').value = today;
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            setupEventListeners();
            
            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
            monitorConnection();
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
            loadAllData();
            
            // Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            document.getElementById('employeeForm').classList.add('hidden');
            document.getElementById('employeeFormMessage').style.display = 'block';
        });

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
        function monitorConnection() {
            const connectedRef = firebase.database().ref(".info/connected");
            connectedRef.on("value", function(snap) {
                if (snap.val() === true) {
                    isConnected = true;
                    connectionRetryCount = 0;
                    connectionStatus.textContent = "âœ“ Ù…ØªØµÙ„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©";
                    connectionStatus.className = "connection-status connection-online";
                    connectionStatus.style.display = "block";
                    
                    // Ø¥Ø°Ø§ ÙƒÙ†Ø§ ØºÙŠØ± Ù…ØªØµÙ„ÙŠÙ† Ø³Ø§Ø¨Ù‚Ø§Ù‹ØŒ Ù†Ø¹ÙŠØ¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    if (!isConnected) {
                        loadAllData();
                    }
                } else {
                    isConnected = false;
                    connectionStatus.textContent = "âœ— ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©";
                    connectionStatus.className = "connection-status connection-offline";
                    connectionStatus.style.display = "block";
                    
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„
                    if (connectionRetryCount < maxRetries) {
                        connectionRetryCount++;
                        setTimeout(() => {
                            if (!isConnected) {
                                monitorConnection();
                            }
                        }, 5000);
                    }
                }
            });
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
        function loadAllData() {
            showLoadingState(true);
            
            Promise.all([
                loadData('employees'),
                loadData('attendance'),
                loadData('leaves'),
                loadData('financials'),
                loadData('employeeDatabase'),
                loadData('cashTransactions'),
                loadData('stations'),
                loadData('supervisors'),
                loadData('faults')
            ]).then(() => {
                showLoadingState(false);
                updateEmployeesDropdowns();
                updateDatabaseEmployeesDropdown();
                updateStationDropdowns();
                updateSupervisorDropdowns();
                updateDashboard();
                displayEmployeesList();
                displayEmployeeDatabase();
                displayAttendanceList();
                displayLeavesList();
                displayFinancialsList();
                displayCashTransactions();
                updateCashStats();
                displayStationsList();
                displaySupervisorsList();
                displayFaultsList();
                
                connectionStatus.textContent = "âœ“ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©";
                connectionStatus.className = "connection-status connection-online";
                connectionStatus.style.display = "block";
                setTimeout(() => {
                    connectionStatus.style.display = "none";
                }, 3000);
            }).catch(error => {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase:', error);
                showLoadingState(false);
                
                connectionStatus.textContent = "âœ— ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©";
                connectionStatus.className = "connection-status connection-offline";
                connectionStatus.style.display = "block";
                
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                showErrorMessage('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
            });
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
        function loadData(dataType) {
            return new Promise((resolve, reject) => {
                database.ref(dataType).once('value')
                    .then((snapshot) => {
                        const data = snapshot.val();
                        
                        if (data) {
                            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† ÙƒØ§Ø¦Ù† Ø¥Ù„Ù‰ Ù…ØµÙÙˆÙØ©
                            const dataArray = Object.keys(data).map(key => {
                                return { id: key, ...data[key] };
                            });
                            
                            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©
                            if (dataType === 'employees') employees = dataArray;
                            else if (dataType === 'attendance') attendance = dataArray;
                            else if (dataType === 'leaves') leaves = dataArray;
                            else if (dataType === 'financials') financials = dataArray;
                            else if (dataType === 'employeeDatabase') employeeDatabase = dataArray;
                            else if (dataType === 'cashTransactions') cashTransactions = dataArray;
                            else if (dataType === 'stations') stations = dataArray;
                            else if (dataType === 'supervisors') supervisors = dataArray;
                            else if (dataType === 'faults') faults = dataArray;
                        } else {
                            // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ù†Ø³ØªØ®Ø¯Ù… Ù…ØµÙÙˆÙØ© ÙØ§Ø±ØºØ©
                            if (dataType === 'employees') employees = [];
                            else if (dataType === 'attendance') attendance = [];
                            else if (dataType === 'leaves') leaves = [];
                            else if (dataType === 'financials') financials = [];
                            else if (dataType === 'employeeDatabase') employeeDatabase = [];
                            else if (dataType === 'cashTransactions') cashTransactions = [];
                            else if (dataType === 'stations') stations = [];
                            else if (dataType === 'supervisors') supervisors = [];
                            else if (dataType === 'faults') faults = [];
                        }
                        
                        resolve();
                    })
                    .catch((error) => {
                        console.error(`Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ${dataType}:`, error);
                        reject(error);
                    });
            });
        }

        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase
        function saveData(dataType, data) {
            return new Promise((resolve, reject) => {
                let dataToSave = {};
                
                if (Array.isArray(data)) {
                    data.forEach(item => {
                        if (item.id) {
                            const { id, ...itemData } = item;
                            dataToSave[id] = itemData;
                        } else {
                            const newId = Date.now().toString();
                            dataToSave[newId] = item;
                        }
                    });
                } else {
                    dataToSave = data;
                }
                
                database.ref(dataType).set(dataToSave)
                    .then(() => {
                        resolve();
                    })
                    .catch((error) => {
                        console.error(`Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ ${dataType} ÙÙŠ Firebase:`, error);
                        reject(error);
                    });
            });
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø¬Ø¯ÙŠØ¯ Ø¥Ù„Ù‰ Firebase
        function addData(dataType, newItem) {
            return new Promise((resolve, reject) => {
                const newId = Date.now().toString() + Math.random().toString(36).substr(2, 5);
                const itemWithId = { id: newId, ...newItem };
                
                database.ref(`${dataType}/${newId}`).set(newItem)
                    .then(() => {
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                        if (dataType === 'employees') employees.push(itemWithId);
                        else if (dataType === 'attendance') attendance.push(itemWithId);
                        else if (dataType === 'leaves') leaves.push(itemWithId);
                        else if (dataType === 'financials') financials.push(itemWithId);
                        else if (dataType === 'employeeDatabase') employeeDatabase.push(itemWithId);
                        else if (dataType === 'cashTransactions') cashTransactions.push(itemWithId);
                        else if (dataType === 'stations') stations.push(itemWithId);
                        else if (dataType === 'supervisors') supervisors.push(itemWithId);
                        else if (dataType === 'faults') faults.push(itemWithId);
                        
                        resolve(itemWithId);
                    })
                    .catch((error) => {
                        console.error(`Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© ${dataType} Ø¥Ù„Ù‰ Firebase:`, error);
                        reject(error);
                    });
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ØµØ± ÙÙŠ Firebase
        function updateData(dataType, id, updatedData) {
            return new Promise((resolve, reject) => {
                database.ref(`${dataType}/${id}`).update(updatedData)
                    .then(() => {
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                        let itemIndex;
                        if (dataType === 'employees') {
                            itemIndex = employees.findIndex(item => item.id === id);
                            if (itemIndex !== -1) employees[itemIndex] = { ...employees[itemIndex], ...updatedData };
                        } else if (dataType === 'attendance') {
                            itemIndex = attendance.findIndex(item => item.id === id);
                            if (itemIndex !== -1) attendance[itemIndex] = { ...attendance[itemIndex], ...updatedData };
                        } else if (dataType === 'leaves') {
                            itemIndex = leaves.findIndex(item => item.id === id);
                            if (itemIndex !== -1) leaves[itemIndex] = { ...leaves[itemIndex], ...updatedData };
                        } else if (dataType === 'financials') {
                            itemIndex = financials.findIndex(item => item.id === id);
                            if (itemIndex !== -1) financials[itemIndex] = { ...financials[itemIndex], ...updatedData };
                        } else if (dataType === 'employeeDatabase') {
                            itemIndex = employeeDatabase.findIndex(item => item.id === id);
                            if (itemIndex !== -1) employeeDatabase[itemIndex] = { ...employeeDatabase[itemIndex], ...updatedData };
                        } else if (dataType === 'cashTransactions') {
                            itemIndex = cashTransactions.findIndex(item => item.id === id);
                            if (itemIndex !== -1) cashTransactions[itemIndex] = { ...cashTransactions[itemIndex], ...updatedData };
                        } else if (dataType === 'stations') {
                            itemIndex = stations.findIndex(item => item.id === id);
                            if (itemIndex !== -1) stations[itemIndex] = { ...stations[itemIndex], ...updatedData };
                        } else if (dataType === 'supervisors') {
                            itemIndex = supervisors.findIndex(item => item.id === id);
                            if (itemIndex !== -1) supervisors[itemIndex] = { ...supervisors[itemIndex], ...updatedData };
                        } else if (dataType === 'faults') {
                            itemIndex = faults.findIndex(item => item.id === id);
                            if (itemIndex !== -1) faults[itemIndex] = { ...faults[itemIndex], ...updatedData };
                        }
                        
                        resolve();
                    })
                    .catch((error) => {
                        console.error(`Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« ${dataType} ÙÙŠ Firebase:`, error);
                        reject(error);
                    });
            });
        }

        // Ø­Ø°Ù Ø¹Ù†ØµØ± Ù…Ù† Firebase
        function deleteData(dataType, id) {
            return new Promise((resolve, reject) => {
                database.ref(`${dataType}/${id}`).remove()
                    .then(() => {
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                        if (dataType === 'employees') employees = employees.filter(item => item.id !== id);
                        else if (dataType === 'attendance') attendance = attendance.filter(item => item.id !== id);
                        else if (dataType === 'leaves') leaves = leaves.filter(item => item.id !== id);
                        else if (dataType === 'financials') financials = financials.filter(item => item.id !== id);
                        else if (dataType === 'employeeDatabase') employeeDatabase = employeeDatabase.filter(item => item.id !== id);
                        else if (dataType === 'cashTransactions') cashTransactions = cashTransactions.filter(item => item.id !== id);
                        else if (dataType === 'stations') stations = stations.filter(item => item.id !== id);
                        else if (dataType === 'supervisors') supervisors = supervisors.filter(item => item.id !== id);
                        else if (dataType === 'faults') faults = faults.filter(item => item.id !== id);
                        
                        resolve();
                    })
                    .catch((error) => {
                        console.error(`Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù ${dataType} Ù…Ù† Firebase:`, error);
                        reject(error);
                    });
            });
        }

        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£
        function showErrorMessage(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-container';
            errorDiv.innerHTML = `
                <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: var(--danger);"></i>
                <p style="margin: 15px 0;">${message}</p>
                <button class="retry-button" onclick="location.reload()">
                    <i class="fas fa-sync-alt"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
                </button>
            `;
            
            const mainContent = document.querySelector('.main-content');
            mainContent.innerHTML = '';
            mainContent.appendChild(errorDiv);
        }

        // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        function showLoadingState(show) {
            const buttons = document.querySelectorAll('button[type="submit"]');
            
            if (show) {
                buttons.forEach(button => {
                    const textSpan = button.querySelector('span');
                    if (textSpan) {
                        textSpan.innerHTML = '<div class="loading"></div> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
                        button.disabled = true;
                    }
                });
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø£Ø®Ø±Ù‰
                const autoAttendanceBtn = document.getElementById('autoAttendanceBtn');
                if (autoAttendanceBtn) {
                    autoAttendanceBtn.querySelector('span').innerHTML = '<div class="loading"></div> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...';
                    autoAttendanceBtn.disabled = true;
                }
                
                const generateReportBtn = document.getElementById('generateReport');
                if (generateReportBtn) {
                    generateReportBtn.querySelector('span').innerHTML = '<div class="loading"></div> Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±...';
                    generateReportBtn.disabled = true;
                }
            } else {
                buttons.forEach(button => {
                    const textSpan = button.querySelector('span');
                    if (textSpan) {
                        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
                        if (button.closest('#employeeForm')) textSpan.textContent = 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù';
                        else if (button.closest('#employeeDatabaseForm')) textSpan.textContent = 'Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
                        else if (button.closest('#manualAttendanceForm')) textSpan.textContent = 'ØªØ³Ø¬ÙŠÙ„';
                        else if (button.closest('#leaveForm')) textSpan.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©';
                        else if (button.closest('#financialForm')) textSpan.textContent = 'ØªØ³Ø¬ÙŠÙ„';
                        else if (button.closest('#depositForm')) textSpan.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹';
                        else if (button.closest('#withdrawalForm')) textSpan.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµØ±Ù';
                        else if (button.closest('#faultForm')) textSpan.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„';
                        else if (button.closest('#stationForm')) textSpan.textContent = 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­Ø·Ø©';
                        else if (button.closest('#supervisorForm')) textSpan.textContent = 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„';
                        button.disabled = false;
                    }
                });
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø£Ø®Ø±Ù‰
                const autoAttendanceBtn = document.getElementById('autoAttendanceBtn');
                if (autoAttendanceBtn) {
                    autoAttendanceBtn.querySelector('span').textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ';
                    autoAttendanceBtn.disabled = false;
                }
                
                const generateReportBtn = document.getElementById('generateReport');
                if (generateReportBtn) {
                    generateReportBtn.querySelector('span').textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±';
                    generateReportBtn.disabled = false;
                }
            }
        }

        // Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙ„Ù…Ø© Ø³Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
        function generateRandomPassword() {
            const word1 = arabicWords[Math.floor(Math.random() * arabicWords.length)];
            const word2 = arabicWords[Math.floor(Math.random() * arabicWords.length)];
            const numbers = Math.floor(Math.random() * 900) + 100; // Ø±Ù‚Ù… Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 100 Ùˆ 999
            
            return `${word1}_${word2}_${numbers}`;
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function setupEventListeners() {
            // ÙØªØ­ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
            menuBtn.addEventListener('click', toggleSideMenu);
            closeMenu.addEventListener('click', toggleSideMenu);
            overlay.addEventListener('click', toggleSideMenu);
            
            // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            exportBtn.addEventListener('click', exportAllData);
            document.getElementById('exportEmployees').addEventListener('click', exportEmployeesToExcel);
            document.getElementById('exportEmployeeDatabase').addEventListener('click', exportEmployeeDatabaseToExcel);
            document.getElementById('exportAttendance').addEventListener('click', exportAttendanceToExcel);
            document.getElementById('exportLeaves').addEventListener('click', exportLeavesToExcel);
            document.getElementById('exportFinancials').addEventListener('click', exportFinancialsToExcel);
            document.getElementById('exportReport').addEventListener('click', exportReportToExcel);
            document.getElementById('exportCash').addEventListener('click', exportCashToExcel);
            document.getElementById('exportFaults').addEventListener('click', exportFaultsToExcel);
            document.getElementById('exportStations').addEventListener('click', exportStationsToExcel);
            document.getElementById('exportSupervisors').addEventListener('click', exportSupervisorsToExcel);
            
            // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
            document.querySelectorAll('.nav-item, .nav-item-attendance, .quick-action, .see-all, .menu-link').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = this.getAttribute('data-target');
                    
                    if (target) {
                        showPage(target);
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø©
                        if (this.classList.contains('nav-item') || this.classList.contains('nav-item-attendance')) {
                            document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                            document.querySelectorAll('.nav-item-attendance').forEach(nav => nav.classList.remove('active'));
                            this.classList.add('active');
                        }
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
                        if (this.classList.contains('menu-link')) {
                            document.querySelectorAll('.menu-link').forEach(link => link.classList.remove('active'));
                            this.classList.add('active');
                            toggleSideMenu(); // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ù‚Ø±
                        }
                    }
                });
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù
            document.getElementById('showAddForm').addEventListener('click', function() {
                const form = document.getElementById('employeeForm');
                const message = document.getElementById('employeeFormMessage');
                
                if (form.classList.contains('hidden')) {
                    form.classList.remove('hidden');
                    message.style.display = 'none';
                    this.textContent = 'Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬';
                } else {
                    form.classList.add('hidden');
                    message.style.display = 'block';
                    this.textContent = 'Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬';
                }
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù
            document.getElementById('employeeForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addEmployee();
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù
            document.getElementById('empName').addEventListener('blur', function() {
                checkEmployeeDuplicate(this.value, 'empNameError');
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
            document.getElementById('empPhone').addEventListener('blur', function() {
                checkPhoneDuplicate(this.value, 'empPhoneError');
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            document.getElementById('employeeDatabaseForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addEmployeeToDatabase();
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            document.getElementById('dbEmpName').addEventListener('blur', function() {
                checkEmployeeDatabaseDuplicate(this.value, 'dbEmpNameError');
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            document.getElementById('dbEmpPhone').addEventListener('blur', function() {
                checkPhoneDatabaseDuplicate(this.value, 'dbEmpPhoneError');
            });
            
            // ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± ÙŠØ¯ÙˆÙŠ
            document.getElementById('manualAttendanceForm').addEventListener('submit', function(e) {
                e.preventDefault();
                recordManualAttendance();
            });
            
            // ØªØ³Ø¬ÙŠÙ„ Ø¥Ø¬Ø§Ø²Ø©
            document.getElementById('leaveForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addLeave();
            });
            
            // ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ© Ù…Ø§Ù„ÙŠØ©
            document.getElementById('financialForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addFinancial();
            });
            
            // Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª
            document.getElementById('generateReport').addEventListener('click', function() {
                generateSalaryReport();
            });
            
            // ØªØµÙÙŠØ© Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±
            document.getElementById('applyAttendanceFilter').addEventListener('click', function() {
                displayAttendanceList();
            });
            
            // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            document.getElementById('searchEmployee').addEventListener('input', function() {
                displayEmployeeDatabase();
            });
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ù‚Ù‹Ø§ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                    // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù‡Ù†Ø§
                }
            });
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            document.getElementById('autoAttendanceBtn').addEventListener('click', function() {
                recordAutoAttendance();
            });
            
            // ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø¹Ù‡Ø¯Ø©
            document.querySelectorAll('.cash-tab[data-tab]').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª ÙˆØ§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
                    document.querySelectorAll('.cash-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.cash-tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù„ØªØ¨ÙˆÙŠØ¨ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø­Ø¯Ø¯
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Ø¥ÙŠØ¯Ø§Ø¹ ÙˆØµØ±Ù Ø§Ù„Ø¹Ù‡Ø¯Ø©
            document.getElementById('depositForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addCashTransaction('deposit');
            });
            
            document.getElementById('withdrawalForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addCashTransaction('withdrawal');
            });
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¨Ø§Ù„Øº ÙÙŠ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø¹Ù‡Ø¯Ø©
            document.getElementById('depositAmount').addEventListener('blur', function() {
                validateAmount(this.value, 'depositAmountError');
            });
            
            document.getElementById('withdrawalAmount').addEventListener('blur', function() {
                validateAmount(this.value, 'withdrawalAmountError');
            });
            
            // ØªØµÙÙŠØ© Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¹Ù‡Ø¯Ø©
            document.getElementById('filterCashMonth').addEventListener('change', function() {
                displayCashTransactions();
            });
            
            document.getElementById('filterCashType').addEventListener('change', function() {
                displayCashTransactions();
            });
            
            // ØªØµÙÙŠØ© Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
            document.getElementById('filterFinancialMonth').addEventListener('change', function() {
                displayFinancialsList();
            });
            
            document.getElementById('filterFinancialType').addEventListener('change', function() {
                displayFinancialsList();
            });
            
            // Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
            document.getElementById('downloadBackupBtn').addEventListener('click', downloadBackup);
            document.getElementById('restoreBackupBtn').addEventListener('click', restoreBackup);
            document.getElementById('deleteAllDataBtn').addEventListener('click', deleteAllData);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Excel Ùˆ CSV
            document.getElementById('downloadTemplateBtn').addEventListener('click', downloadTemplate);
            document.getElementById('previewImportBtn').addEventListener('click', previewImport);
            document.getElementById('importEmployeesBtn').addEventListener('click', importEmployees);
            document.getElementById('importFromDatabaseBtn').addEventListener('click', importFromDatabase);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
            document.getElementById('importContactsBtn').addEventListener('click', importContacts);
            document.getElementById('selectAllContacts').addEventListener('click', selectAllContacts);
            document.getElementById('deselectAllContacts').addEventListener('click', deselectAllContacts);
            document.getElementById('addSelectedContactsBtn').addEventListener('click', addSelectedContacts);
            
            // ÙÙ„ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
            document.getElementById('applyLeaveFilter').addEventListener('click', function() {
                displayLeavesList();
            });
            
            document.getElementById('resetLeaveFilter').addEventListener('click', function() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('leaveFilterStartDate').value = today;
                document.getElementById('leaveFilterEndDate').value = today;
                document.getElementById('filterLeaveStation').value = '';
                displayLeavesList();
            });
            
            // ØµÙØ­Ø© Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            document.getElementById('generateEmployeeReportBtn').addEventListener('click', generateEmployeeReport);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø·Ø©
            document.getElementById('stationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addStation();
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø¤ÙˆÙ„ (Ù…Ø¹ Ø²Ø± Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙ„Ù…Ø© Ø³Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©)
            document.getElementById('generatePasswordBtn').addEventListener('click', function() {
                const passwordField = document.getElementById('supervisorPassword');
                passwordField.value = generateRandomPassword();
            });
            
            document.getElementById('supervisorForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addSupervisor();
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø¹Ø·Ù„
            document.getElementById('faultForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addFault();
            });
            
            // ÙÙ„ØªØ±Ø© Ø§Ù„Ø£Ø¹Ø·Ø§Ù„
            document.getElementById('applyFaultFilter').addEventListener('click', function() {
                displayFaultsList();
            });
            
            document.getElementById('resetFaultFilter').addEventListener('click', function() {
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('filterFaultStartDate').value = today;
                document.getElementById('filterFaultEndDate').value = today;
                document.getElementById('filterFaultStation').value = '';
                document.getElementById('filterFaultStatus').value = '';
                displayFaultsList();
            });
            
            // ÙÙ„ØªØ±Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
            document.getElementById('dashboardStationFilter').addEventListener('change', function() {
                updateDashboard();
            });
            
            // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            document.getElementById('saveSettingsBtn').addEventListener('click', function() {
                alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø­Ø·Ø§Øª
        function updateStationDropdowns() {
            const dropdowns = [
                'attendanceStation',
                'leaveStation',
                'financialStation',
                'faultStation',
                'filterAttendanceStation',
                'filterLeaveStation',
                'filterFinancialStation',
                'filterFaultStation',
                'dashboardStationFilter'
            ];
            
            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (!dropdown) return;
                
                dropdown.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø·Ø©</option>';
                
                stations.forEach(station => {
                    const option = document.createElement('option');
                    option.value = station.name;
                    option.textContent = station.name;
                    dropdown.appendChild(option);
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ø®ÙŠØ§Ø± "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø·Ø§Øª" Ù„Ù„ÙÙ„Ø§ØªØ±
                if (dropdownId.includes('filter') || dropdownId === 'dashboardStationFilter') {
                    const allOption = document.createElement('option');
                    allOption.value = '';
                    allOption.textContent = 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø·Ø§Øª';
                    dropdown.prepend(allOption);
                }
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†
        function updateSupervisorDropdowns() {
            const dropdowns = [
                'attendanceSupervisor',
                'leaveSupervisor',
                'financialSupervisor',
                'depositSupervisor',
                'withdrawalSupervisor',
                'faultSupervisor'
            ];
            
            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (!dropdown) return;
                
                dropdown.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>';
                
                supervisors.forEach(sup => {
                    if (sup.active) {
                        const option = document.createElement('option');
                        option.value = sup.employeeId;
                        option.textContent = sup.employeeName;
                        dropdown.appendChild(option);
                    }
                });
            });
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©
        function addStation() {
            showLoadingState(true);
            
            const name = document.getElementById('stationName').value;
            const type = document.getElementById('stationType').value;
            const governorate = document.getElementById('stationGovernorate').value;
            const area = document.getElementById('stationArea').value;
            const address = document.getElementById('stationAddress').value;
            
            if (!name || !type || !governorate || !area || !address) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                showLoadingState(false);
                return;
            }
            
            const newStation = {
                name,
                type,
                governorate,
                area,
                address,
                createdAt: new Date().toISOString()
            };
            
            addData('stations', newStation)
                .then(() => {
                    document.getElementById('stationForm').reset();
                    
                    showLoadingState(false);
                    alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­Ø·Ø© Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­Ø·Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø·Ø§Øª
        function displayStationsList() {
            const container = document.getElementById('stationsList');
            container.innerHTML = '';
            
            if (stations.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø·Ø§Øª Ù…Ø³Ø¬Ù„Ø©</div>';
                return;
            }
            
            stations.forEach(station => {
                const item = document.createElement('div');
                item.className = 'list-item';
                
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${station.name}</div>
                        <div class="item-subtitle">
                            <span class="station-type">${station.type}</span>
                        </div>
                        <div class="item-subtitle">
                            <span>${station.governorate} - ${station.area}</span>
                        </div>
                        <div class="item-subtitle">${station.address}</div>
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editStation('${station.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteStation('${station.id}')">Ø­Ø°Ù</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // Ø­Ø°Ù Ù…Ø­Ø·Ø©
        function deleteStation(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø·Ø©ØŸ')) {
                deleteData('stations', id)
                    .then(() => {
                        alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø·Ø© Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø·Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    });
            }
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ù…Ø­Ø·Ø©
        function editStation(id) {
            const station = stations.find(s => s.id === id);
            if (!station) return;
            
            document.getElementById('stationName').value = station.name;
            document.getElementById('stationType').value = station.type;
            document.getElementById('stationGovernorate').value = station.governorate;
            document.getElementById('stationArea').value = station.area;
            document.getElementById('stationAddress').value = station.address;
            
            deleteData('stations', id)
                .then(() => {
                    alert('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø·Ø© ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                    showPage('stations');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø·Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø¤ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ (Ù…Ø¹ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±)
        function addSupervisor() {
            showLoadingState(true);
            
            const employeeId = document.getElementById('supervisorEmployee').value;
            const password = document.getElementById('supervisorPassword').value;
            const active = document.getElementById('supervisorActive').value === 'true';
            
            if (!employeeId) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…ÙˆØ¸Ù');
                showLoadingState(false);
                return;
            }
            
            if (!password) {
                document.getElementById('supervisorPasswordError').style.display = 'block';
                showLoadingState(false);
                return;
            } else {
                document.getElementById('supervisorPasswordError').style.display = 'none';
            }
            
            const employee = employeeDatabase.find(emp => emp.id === employeeId);
            if (!employee) {
                alert('Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                showLoadingState(false);
                return;
            }
            
            const existingSupervisor = supervisors.find(sup => sup.employeeId === employeeId);
            if (existingSupervisor) {
                alert('Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸Ù Ù…Ø¶Ø§Ù Ø¨Ø§Ù„ÙØ¹Ù„ ÙƒÙ…Ø³Ø¤ÙˆÙ„');
                showLoadingState(false);
                return;
            }
            
            const newSupervisor = {
                employeeId: employee.id,
                employeeName: employee.name,
                employeePhone: employee.phone,
                password: password, // Ø­ÙØ¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
                active: active,
                createdAt: new Date().toISOString()
            };
            
            addData('supervisors', newSupervisor)
                .then(() => {
                    document.getElementById('supervisorForm').reset();
                    document.getElementById('supervisorActive').value = 'true';
                    
                    showLoadingState(false);
                    alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† (Ù…Ø¹ Ø¥Ø¸Ù‡Ø§Ø± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±)
        function displaySupervisorsList() {
            const container = document.getElementById('supervisorsList');
            container.innerHTML = '';
            
            if (supervisors.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†</div>';
                return;
            }
            
            supervisors.forEach(sup => {
                const item = document.createElement('div');
                item.className = 'list-item';
                
                const statusClass = sup.active ? 'status-active' : 'status-inactive';
                const statusText = sup.active ? 'ÙØ¹Ø§Ù„' : 'ØºÙŠØ± ÙØ¹Ø§Ù„';
                
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${sup.employeeName}</div>
                        <div class="item-subtitle">${sup.employeePhone}</div>
                        <div class="item-subtitle">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±: ${sup.password}</div> <!-- Ø¹Ø±Ø¶ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± -->
                        <div class="employee-status ${statusClass}">${statusText}</div>
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editSupervisor('${sup.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteSupervisor('${sup.id}')">Ø­Ø°Ù</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // Ø­Ø°Ù Ù…Ø³Ø¤ÙˆÙ„
        function deleteSupervisor(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ØŸ')) {
                deleteData('supervisors', id)
                    .then(() => {
                        alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    });
            }
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³Ø¤ÙˆÙ„
        function editSupervisor(id) {
            const sup = supervisors.find(s => s.id === id);
            if (!sup) return;
            
            document.getElementById('supervisorEmployee').value = sup.employeeId;
            document.getElementById('supervisorPassword').value = sup.password; // Ø¹Ø±Ø¶ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
            document.getElementById('supervisorActive').value = sup.active.toString();
            
            deleteData('supervisors', id)
                .then(() => {
                    alert('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙˆØ¥Ø¶Ø§ÙØªÙ‡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                    showPage('supervisors');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¹Ø·Ù„ Ø¬Ø¯ÙŠØ¯
        function addFault() {
            showLoadingState(true);
            
            const stationName = document.getElementById('faultStation').value;
            const supervisorId = document.getElementById('faultSupervisor').value;
            const title = document.getElementById('faultTitle').value;
            const description = document.getElementById('faultDescription').value;
            const date = document.getElementById('faultDate').value;
            const status = document.getElementById('faultStatus').value;
            
            if (!stationName || !supervisorId || !title || !description || !date || !status) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                showLoadingState(false);
                return;
            }
            
            const supervisor = supervisors.find(sup => sup.employeeId === supervisorId);
            
            const newFault = {
                stationName,
                supervisorId,
                supervisorName: supervisor ? supervisor.employeeName : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
                title,
                description,
                date,
                status,
                createdAt: new Date().toISOString()
            };
            
            addData('faults', newFault)
                .then(() => {
                    document.getElementById('faultForm').reset();
                    document.getElementById('faultDate').value = new Date().toISOString().split('T')[0];
                    
                    showLoadingState(false);
                    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„ Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø·Ø§Ù„
        function displayFaultsList() {
            const container = document.getElementById('faultsList');
            container.innerHTML = '';
            
            const stationFilter = document.getElementById('filterFaultStation').value;
            const statusFilter = document.getElementById('filterFaultStatus').value;
            const startDate = document.getElementById('filterFaultStartDate').value;
            const endDate = document.getElementById('filterFaultEndDate').value;
            
            let filteredFaults = faults;
            
            if (stationFilter) {
                filteredFaults = filteredFaults.filter(fault => fault.stationName === stationFilter);
            }
            
            if (statusFilter) {
                filteredFaults = filteredFaults.filter(fault => fault.status === statusFilter);
            }
            
            if (startDate && endDate) {
                filteredFaults = filteredFaults.filter(fault => {
                    return fault.date >= startDate && fault.date <= endDate;
                });
            }
            
            if (filteredFaults.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¹Ø·Ø§Ù„ Ù…Ø³Ø¬Ù„Ø©</div>';
                return;
            }
            
            filteredFaults.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            filteredFaults.forEach(fault => {
                const item = document.createElement('div');
                item.className = 'list-item';
                
                let statusClass = '';
                let statusText = '';
                
                if (fault.status === 'fixed') {
                    statusClass = 'fault-fixed';
                    statusText = 'ØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­';
                } else if (fault.status === 'in-progress') {
                    statusClass = 'fault-in-progress';
                    statusText = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥ØµÙ„Ø§Ø­';
                } else {
                    statusClass = 'fault-pending';
                    statusText = 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­';
                }
                
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${fault.title}</div>
                        <div class="item-subtitle">
                            <span class="station-badge">${fault.stationName}</span>
                            <span class="${statusClass}">${statusText}</span>
                        </div>
                        <div class="item-subtitle">
                            <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: ${fault.supervisorName}</span>
                            <span>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${fault.date}</span>
                        </div>
                        <div class="item-subtitle">${fault.description}</div>
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editFault('${fault.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteFault('${fault.id}')">Ø­Ø°Ù</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // Ø­Ø°Ù Ø¹Ø·Ù„
        function deleteFault(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø·Ù„ØŸ')) {
                deleteData('faults', id)
                    .then(() => {
                        alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ø·Ù„ Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¹Ø·Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    });
            }
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø·Ù„
        function editFault(id) {
            const fault = faults.find(f => f.id === id);
            if (!fault) return;
            
            document.getElementById('faultStation').value = fault.stationName;
            document.getElementById('faultSupervisor').value = fault.supervisorId;
            document.getElementById('faultTitle').value = fault.title;
            document.getElementById('faultDescription').value = fault.description;
            document.getElementById('faultDate').value = fault.date;
            document.getElementById('faultStatus').value = fault.status;
            
            deleteData('faults', id)
                .then(() => {
                    alert('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„ ÙˆØªØ³Ø¬ÙŠÙ„Ù‡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                    showPage('faults');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¹Ø·Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø¥Ù„Ù‰ Excel
        function exportFaultsToExcel() {
            const data = faults.map(fault => {
                let statusText = '';
                if (fault.status === 'fixed') statusText = 'ØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­';
                else if (fault.status === 'in-progress') statusText = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥ØµÙ„Ø§Ø­';
                else statusText = 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­';
                
                return {
                    'Ø§Ù„Ù…Ø­Ø·Ø©': fault.stationName,
                    'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„': fault.supervisorName,
                    'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø·Ù„': fault.title,
                    'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„': fault.description,
                    'Ø§Ù„ØªØ§Ø±ÙŠØ®': fault.date,
                    'Ø§Ù„Ø­Ø§Ù„Ø©': statusText
                };
            });
            
            exportToExcel(data, 'Ø³Ø¬Ù„_Ø§Ù„Ø£Ø¹Ø·Ø§Ù„');
        }

        // ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø­Ø·Ø§Øª Ø¥Ù„Ù‰ Excel
        function exportStationsToExcel() {
            const data = stations.map(station => ({
                'Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø·Ø©': station.name,
                'Ø§Ù„Ù†ÙˆØ¹': station.type,
                'Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©': station.governorate,
                'Ø§Ù„Ù…Ù†Ø·Ù‚Ø©': station.area,
                'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†': station.address
            }));
            
            exportToExcel(data, 'Ù‚Ø§Ø¦Ù…Ø©_Ø§Ù„Ù…Ø­Ø·Ø§Øª');
        }

        // ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ø¥Ù„Ù‰ Excel (Ù…Ø¹ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±)
        function exportSupervisorsToExcel() {
            const data = supervisors.map(sup => ({
                'Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„': sup.employeeName,
                'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ': sup.employeePhone,
                'ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±': sup.password, // ØªØµØ¯ÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±
                'Ø§Ù„Ø­Ø§Ù„Ø©': sup.active ? 'ÙØ¹Ø§Ù„' : 'ØºÙŠØ± ÙØ¹Ø§Ù„',
                'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¶Ø§ÙØ©': sup.createdAt ? new Date(sup.createdAt).toLocaleDateString('ar-EG') : ''
            }));
            
            exportToExcel(data, 'Ù‚Ø§Ø¦Ù…Ø©_Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†');
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†
        function updateSupervisorEmployeesDropdown() {
            const dropdown = document.getElementById('supervisorEmployee');
            if (!dropdown) return;
            
            dropdown.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</option>';
            
            employeeDatabase.forEach(emp => {
                const isAlreadySupervisor = supervisors.some(sup => sup.employeeId === emp.id);
                if (!isAlreadySupervisor) {
                    const option = document.createElement('option');
                    option.value = emp.id;
                    option.textContent = `${emp.name} - ${emp.phone}`;
                    dropdown.appendChild(option);
                }
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© updateDashboard
        function updateDashboard() {
            const currentMonth = new Date().toISOString().slice(0, 7);
            const today = new Date().toISOString().split('T')[0];
            const selectedStation = document.getElementById('dashboardStationFilter').value;
            
            // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
            const activeEmployees = employees.filter(emp => emp.active);
            document.getElementById('totalEmployees').textContent = activeEmployees.length;
            
            // Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ… Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø·Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© - Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ… ÙÙ‚Ø·
            let todayAttendanceRecords = attendance.filter(record => {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ØªØ§Ø±ÙŠØ® Ù‡Ùˆ Ø§Ù„ÙŠÙˆÙ… ÙÙ‚Ø·
                if (record.date === today && (record.status === 'Ø­Ø§Ø¶Ø±' || record.status === 'Ø¥Ø¬Ø§Ø²Ø©')) {
                    const employee = employees.find(emp => emp.name === record.employeeName && emp.active);
                    if (employee) {
                        // Ø¥Ø°Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­Ø·Ø© Ù…Ø­Ø¯Ø¯Ø©ØŒ Ù†Ø¹Ø±Ø¶ Ø³Ø¬Ù„Ø§Øª ØªÙ„Ùƒ Ø§Ù„Ù…Ø­Ø·Ø© ÙÙ‚Ø·
                        if (selectedStation) {
                            return record.stationName === selectedStation;
                        }
                        // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ø­Ø·Ø© (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø·Ø§Øª)ØŒ Ù†Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                        return true;
                    }
                }
                return false;
            });
            
            document.getElementById('todayAttendance').textContent = todayAttendanceRecords.length;
            
            // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª
            document.getElementById('totalStations').textContent = stations.length;
            
            // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ù„Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ
            const totalRewards = financials
                .filter(f => f.type === 'Ù…ÙƒØ§ÙØ£Ø©' && f.date.startsWith(currentMonth))
                .reduce((sum, f) => sum + f.amount, 0);
            document.getElementById('monthlyLeaves').textContent = totalRewards + ' Ø¬.Ù…';
            
            // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù„Ù Ù„Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ
            const totalLoans = financials
                .filter(f => f.type === 'Ø³Ù„ÙØ©' && f.date.startsWith(currentMonth))
                .reduce((sum, f) => sum + f.amount, 0);
            document.getElementById('totalLoans').textContent = totalLoans + ' Ø¬.Ù…';
            
            // Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ù†Ø´Ø·Ø© (Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø£Ùˆ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥ØµÙ„Ø§Ø­)
            const activeFaults = faults.filter(f => f.status !== 'fixed').length;
            document.getElementById('activeFaults').textContent = activeFaults;
            
            // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ù‡Ø¯Ø©
            updateCashStats();
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ
            const todayList = document.getElementById('todayAttendanceList');
            todayList.innerHTML = '';
            
            if (todayAttendanceRecords.length === 0) {
                todayList.innerHTML = '<div class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø­Ø¶ÙˆØ± Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…</div>';
                return;
            }
            
            // ØªØ¬Ù…ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø·Ø© Ù„Ø¹Ø±Ø¶Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø¸Ù…
            const attendanceByStation = {};
            todayAttendanceRecords.forEach(record => {
                const station = record.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                if (!attendanceByStation[station]) {
                    attendanceByStation[station] = [];
                }
                attendanceByStation[station].push(record);
            });
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù…Ø±ØªØ¨Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø·Ø©
            for (const station in attendanceByStation) {
                const stationRecords = attendanceByStation[station];
                
                // Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø­Ø·Ø©
                const stationHeader = document.createElement('div');
                stationHeader.style.cssText = 'font-weight: bold; margin: 10px 0 5px; color: var(--primary);';
                stationHeader.innerHTML = `<i class="fas fa-map-marker-alt"></i> ${station}`;
                todayList.appendChild(stationHeader);
                
                stationRecords.forEach(record => {
                    const item = document.createElement('div');
                    item.className = 'list-item';
                    
                    // ØªØ­Ø¯ÙŠØ¯ ÙƒÙ„Ø§Ø³ Ø§Ù„Ø­Ø§Ù„Ø©
                    let statusClass = '';
                    if (record.status === 'Ø­Ø§Ø¶Ø±') statusClass = 'status-present';
                    else if (record.status === 'Ø¥Ø¬Ø§Ø²Ø©') statusClass = 'status-leave';
                    
                    item.innerHTML = `
                        <div class="item-info">
                            <div class="item-title">${record.employeeName}</div>
                            <div class="item-subtitle">
                                <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: ${record.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                            </div>
                        </div>
                        <div class="${statusClass}">
                            ${record.status === 'Ø­Ø§Ø¶Ø±' ? 'âœ… Ø­Ø§Ø¶Ø±' : record.status === 'Ø¥Ø¬Ø§Ø²Ø©' ? 'ğŸŒ´ Ø¥Ø¬Ø§Ø²Ø©' : record.status}
                        </div>
                    `;
                    todayList.appendChild(item);
                });
            }
        }

        // ==================== ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ====================
        function updateEmployeesDropdowns() {
            const dropdowns = [
                'attendanceEmployee',
                'leaveEmployee',
                'financialEmployee',
                'selectEmployeeForReport'
            ];
            
            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (!dropdown) return;
                
                dropdown.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù</option>';
                
                employees.forEach(emp => {
                    if (emp.active) {
                        const option = document.createElement('option');
                        option.value = emp.name;
                        option.textContent = emp.name;
                        dropdown.appendChild(option);
                    }
                });
            });
        }

        // ==================== ÙÙ„ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® ====================
        function displayLeavesList() {
            const container = document.getElementById('leavesList');
            container.innerHTML = '';
            
            const startDate = document.getElementById('leaveFilterStartDate').value;
            const endDate = document.getElementById('leaveFilterEndDate').value;
            const stationFilter = document.getElementById('filterLeaveStation').value;
            
            if (!startDate || !endDate) {
                container.innerHTML = '<div class="empty-state">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ©</div>';
                return;
            }
            
            if (new Date(startDate) > new Date(endDate)) {
                container.innerHTML = '<div class="empty-state">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù‚Ø¨Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</div>';
                return;
            }
            
            // ÙÙ„ØªØ±Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø²Ù…Ù†ÙŠ ÙˆØ§Ù„Ù…Ø­Ø·Ø©
            let filteredLeaves = leaves.filter(leave => {
                const leaveStart = new Date(leave.start);
                const leaveEnd = new Date(leave.end);
                const filterStart = new Date(startDate);
                const filterEnd = new Date(endDate);
                
                // ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØªØ¯Ø§Ø®Ù„ Ø¨ÙŠÙ† ÙØªØ±ØªÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© ÙˆØ§Ù„ÙÙ„ØªØ±
                const dateMatch = (leaveStart <= filterEnd && leaveEnd >= filterStart);
                const stationMatch = !stationFilter || leave.stationName === stationFilter;
                
                return dateMatch && stationMatch;
            });
            
            if (filteredLeaves.length === 0) {
                container.innerHTML = `<div class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø²Ø§Øª Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø§Ù„ÙØªØ±Ø© Ù…Ù† ${startDate} Ø¥Ù„Ù‰ ${endDate}</div>`;
                return;
            }
            
            filteredLeaves.forEach(leave => {
                // Ø­Ø³Ø§Ø¨ Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©
                const startDateObj = new Date(leave.start);
                const endDateObj = new Date(leave.end);
                const duration = Math.ceil((endDateObj - startDateObj) / (1000 * 60 * 60 * 24)) + 1;
                
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${leave.employeeName}</div>
                        <div class="item-subtitle">
                            <span class="station-badge">${leave.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                            <span>${leave.type} - ${duration} ÙŠÙˆÙ…</span>
                        </div>
                        <div class="item-subtitle">
                            <span>${leave.start} Ø¥Ù„Ù‰ ${leave.end}</span>
                            <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: ${leave.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editLeave('${leave.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteLeave('${leave.id}')">Ø­Ø°Ù</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // ==================== ØµÙØ­Ø© Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…Ø­Ø³Ù†Ø© ====================
        function generateEmployeeReport() {
            const employeeName = document.getElementById('selectEmployeeForReport').value;
            const month = document.getElementById('selectMonthForReport').value;
            
            if (!employeeName || !month) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¸Ù ÙˆØ§Ù„Ø´Ù‡Ø±');
                return;
            }
            
            const employee = employees.find(emp => emp.name === employeeName && emp.active);
            if (!employee) {
                alert('Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ ØºÙŠØ± ÙØ¹Ø§Ù„');
                return;
            }
            
            // ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const reportData = prepareEmployeeMonthlyReport(employee, month);
            
            // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù„Ù„ØªØµØ¯ÙŠØ±
            currentReportData = reportData;
            
            // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
            displayEmployeeReport(reportData, employee, month);
        }

        function prepareEmployeeMonthlyReport(employee, month) {
            const reportData = {
                employeeName: employee.name,
                month: month,
                attendance: [],
                leaves: [],
                financials: [],
                summary: {
                    totalPresent: 0,
                    totalAbsent: 0,
                    totalLeaves: 0,
                    totalRewards: 0,
                    totalLoans: 0,
                    totalDeductions: 0,
                    netSalary: 0,
                    extraDays: 0,
                    extraSalary: 0,
                    baseSalary: 0
                }
            };
            
            // Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
            const monthAttendance = attendance.filter(record => 
                record.employeeName === employee.name && 
                record.date.startsWith(month)
            );
            
            reportData.attendance = monthAttendance;
            
            // Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø¶ÙˆØ±
            reportData.summary.totalPresent = monthAttendance.filter(a => a.status === 'Ø­Ø§Ø¶Ø±').length;
            reportData.summary.totalAbsent = monthAttendance.filter(a => a.status === 'ØºØ§Ø¦Ø¨').length;
            reportData.summary.totalLeaves = monthAttendance.filter(a => a.status === 'Ø¥Ø¬Ø§Ø²Ø©').length;
            
            // Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
            const monthLeaves = leaves.filter(leave => 
                leave.employeeName === employee.name && 
                leave.start.startsWith(month)
            );
            
            reportData.leaves = monthLeaves;
            
            // Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
            const monthFinancials = financials.filter(f => 
                f.employeeName === employee.name && 
                f.date.startsWith(month)
            );
            
            reportData.financials = monthFinancials;
            
            // Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
            reportData.summary.totalRewards = monthFinancials
                .filter(f => f.type === 'Ù…ÙƒØ§ÙØ£Ø©')
                .reduce((sum, f) => sum + f.amount, 0);
            
            reportData.summary.totalLoans = monthFinancials
                .filter(f => f.type === 'Ø³Ù„ÙØ©')
                .reduce((sum, f) => sum + f.amount, 0);
            
            reportData.summary.totalDeductions = monthFinancials
                .filter(f => f.type === 'Ø®ØµÙ…')
                .reduce((sum, f) => sum + f.amount, 0);
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø§ØªØ¨
            const dailyRate = employee.salary / 30;
            let netSalary = 0;
            let extraDays = 0;
            let extraSalary = 0;
            let baseSalary = 0;
            
            if (reportData.summary.totalPresent >= employee.workDays) {
                baseSalary = employee.salary;
                
                if (reportData.summary.totalPresent > employee.workDays) {
                    extraDays = reportData.summary.totalPresent - employee.workDays;
                    extraSalary = extraDays * dailyRate;
                    netSalary = baseSalary + extraSalary;
                } else {
                    netSalary = baseSalary;
                }
            } else {
                baseSalary = reportData.summary.totalPresent * dailyRate;
                netSalary = baseSalary;
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª ÙˆØ·Ø±Ø­ Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ø®ØµÙˆÙ…Ø§Øª
            netSalary = netSalary + reportData.summary.totalRewards - 
                        reportData.summary.totalLoans - reportData.summary.totalDeductions;
            
            reportData.summary.baseSalary = baseSalary;
            reportData.summary.extraDays = extraDays;
            reportData.summary.extraSalary = extraSalary;
            reportData.summary.netSalary = Math.round(netSalary);
            
            return reportData;
        }

        function displayEmployeeReport(reportData, employee, month) {
            const container = document.getElementById('employeeReportContainer');
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø­Ø³Ù†
            container.innerHTML = `
                <div class="employee-report-card">
                    <div class="employee-report-header">
                        <i class="fas fa-user"></i> ØªÙ‚Ø±ÙŠØ± ${employee.name} - ${month}
                    </div>
                    <div class="employee-report-body">
                        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© -->
                        <div class="report-info-grid">
                            <div class="report-info-item">
                                <span class="report-info-label">Ø§Ù„ÙˆØ¸ÙŠÙØ©</span>
                                <span class="report-info-value">${employee.job}</span>
                            </div>
                            <div class="report-info-item">
                                <span class="report-info-label">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</span>
                                <span class="report-info-value">${employee.salary} Ø¬.Ù…</span>
                            </div>
                            <div class="report-info-item">
                                <span class="report-info-label">Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§</span>
                                <span class="report-info-value">${employee.workDays} ÙŠÙˆÙ…</span>
                            </div>
                            <div class="report-info-item">
                                <span class="report-info-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</span>
                                <span class="report-info-value">${employee.phone}</span>
                            </div>
                        </div>
                        
                        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø¶ÙˆØ± -->
                        <div class="attendance-stats">
                            <div class="attendance-stat present">
                                <div class="attendance-stat-value">${reportData.summary.totalPresent}</div>
                                <div class="attendance-stat-label">Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±</div>
                            </div>
                            <div class="attendance-stat absent">
                                <div class="attendance-stat-value">${reportData.summary.totalAbsent}</div>
                                <div class="attendance-stat-label">Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨</div>
                            </div>
                            <div class="attendance-stat leave">
                                <div class="attendance-stat-value">${reportData.summary.totalLeaves}</div>
                                <div class="attendance-stat-label">Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</div>
                            </div>
                        </div>
                        
                        <!-- Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© -->
                        <div class="daily-report-table">
                            <h4 style="padding: 15px; margin: 0; background: #f8f9fa; border-bottom: 2px solid var(--primary);">
                                <i class="fas fa-calendar-alt"></i> Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
                            </h4>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Ø§Ù„ÙŠÙˆÙ…</th>
                                        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                        <th>Ø§Ù„Ù…Ø­Ø·Ø©</th>
                                        <th>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</th>
                                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                        <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody id="dailyDetailsBody">
                                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø§ØªØ¨ -->
                        <div class="salary-summary">
                            <h4><i class="fas fa-chart-pie"></i> Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ</h4>
                            <div class="salary-breakdown">
                                <div class="breakdown-item">
                                    <div class="breakdown-label">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</div>
                                    <div class="breakdown-value">${reportData.summary.baseSalary.toFixed(2)} Ø¬.Ù…</div>
                                </div>
                                ${reportData.summary.extraDays > 0 ? `
                                <div class="breakdown-item">
                                    <div class="breakdown-label">Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</div>
                                    <div class="breakdown-value positive">+ ${reportData.summary.extraDays} ÙŠÙˆÙ…</div>
                                </div>
                                <div class="breakdown-item">
                                    <div class="breakdown-label">Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</div>
                                    <div class="breakdown-value positive">+ ${reportData.summary.extraSalary.toFixed(2)} Ø¬.Ù…</div>
                                </div>
                                ` : ''}
                                <div class="breakdown-item">
                                    <div class="breakdown-label">Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</div>
                                    <div class="breakdown-value positive">+ ${reportData.summary.totalRewards} Ø¬.Ù…</div>
                                </div>
                                <div class="breakdown-item">
                                    <div class="breakdown-label">Ø§Ù„Ø³Ù„Ù</div>
                                    <div class="breakdown-value negative">- ${reportData.summary.totalLoans} Ø¬.Ù…</div>
                                </div>
                                <div class="breakdown-item">
                                    <div class="breakdown-label">Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª</div>
                                    <div class="breakdown-value negative">- ${reportData.summary.totalDeductions} Ø¬.Ù…</div>
                                </div>
                            </div>
                            <div class="net-salary">
                                <h3>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨: ${reportData.summary.netSalary} Ø¬.Ù…</h3>
                            </div>
                        </div>
                        
                        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button class="btn-success" onclick="exportEmployeeReportToExcel()" style="flex: 1;">
                                <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                            </button>
                            <button class="btn-whatsapp" onclick="sendEmployeeReportWhatsApp()" style="flex: 1;">
                                <i class="fab fa-whatsapp"></i> Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
            const dailyBody = document.getElementById('dailyDetailsBody');
            dailyBody.innerHTML = '';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠØ§Ù… Ø§Ù„Ø´Ù‡Ø±
            const [year, monthNum] = month.split('-').map(Number);
            const daysInMonth = new Date(year, monthNum, 0).getDate();
            const arabicDays = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${monthNum.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                const dateObj = new Date(dateStr);
                const dayName = arabicDays[dateObj.getDay()];
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
                const attendanceRecord = reportData.attendance.find(a => a.date === dateStr);
                let status = 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„';
                let statusClass = '';
                let stationName = '';
                let supervisorName = '';
                let notes = '';
                
                if (attendanceRecord) {
                    status = attendanceRecord.status;
                    stationName = attendanceRecord.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    supervisorName = attendanceRecord.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    
                    if (status === 'Ø­Ø§Ø¶Ø±') statusClass = 'status-present';
                    else if (status === 'ØºØ§Ø¦Ø¨') statusClass = 'status-absent';
                    else if (status === 'Ø¥Ø¬Ø§Ø²Ø©') statusClass = 'status-leave';
                    
                    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¬Ø§Ø²Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
                    const leaveRecord = reportData.leaves.find(l => {
                        const startDate = new Date(l.start);
                        const endDate = new Date(l.end);
                        const currentDate = new Date(dateStr);
                        return currentDate >= startDate && currentDate <= endDate;
                    });
                    
                    if (leaveRecord) {
                        notes = `Ø¥Ø¬Ø§Ø²Ø©: ${leaveRecord.type}`;
                        if (leaveRecord.notes) {
                            notes += ` - ${leaveRecord.notes}`;
                        }
                    }
                }
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="day-name">${dayName}</td>
                    <td>${dateStr}</td>
                    <td>${stationName}</td>
                    <td>${supervisorName}</td>
                    <td class="${statusClass}">${status}</td>
                    <td>${notes}</td>
                `;
                dailyBody.appendChild(row);
            }
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø­Ø§ÙˆÙŠØ©
            container.style.display = 'block';
            
            // ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
            container.scrollIntoView({ behavior: 'smooth' });
        }

        // ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Excel
        function exportEmployeeReportToExcel() {
            if (!currentReportData) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±. ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ„Ø§Ù‹.');
                return;
            }
            
            const employeeName = currentReportData.employeeName;
            const month = currentReportData.month;
            const summary = currentReportData.summary;
            
            // ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ±
            const exportData = [];
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù
            exportData.push(['ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø´Ù‡Ø±ÙŠ', '', '', '', '', '']);
            exportData.push(['Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù', employeeName, '', '', '', '']);
            exportData.push(['Ø§Ù„Ø´Ù‡Ø±', month, '', '', '', '']);
            exportData.push(['', '', '', '', '', '']);
            
            // Ø¥Ø¶Ø§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø§ØªØ¨
            exportData.push(['ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø§ØªØ¨', '', '', '', '', '']);
            exportData.push(['Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ', `${summary.baseSalary.toFixed(2)} Ø¬.Ù…`, '', '', '', '']);
            exportData.push(['Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±', `${summary.totalPresent} ÙŠÙˆÙ…`, '', '', '', '']);
            
            if (summary.extraDays > 0) {
                exportData.push(['Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©', `${summary.extraDays} ÙŠÙˆÙ…`, '', '', '', '']);
                exportData.push(['Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©', `${summary.extraSalary.toFixed(2)} Ø¬.Ù…`, '', '', '', '']);
            }
            
            exportData.push(['Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª', `${summary.totalRewards} Ø¬.Ù…`, '', '', '', '']);
            exportData.push(['Ø§Ù„Ø³Ù„Ù', `${summary.totalLoans} Ø¬.Ù…`, '', '', '', '']);
            exportData.push(['Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª', `${summary.totalDeductions} Ø¬.Ù…`, '', '', '', '']);
            exportData.push(['ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨', `${summary.netSalary} Ø¬.Ù…`, '', '', '', '']);
            
            exportData.push(['', '', '', '', '', '']);
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
            exportData.push(['Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©', '', '', '', '', '']);
            exportData.push(['Ø§Ù„ÙŠÙˆÙ…', 'Ø§Ù„ØªØ§Ø±ÙŠØ®', 'Ø§Ù„Ù…Ø­Ø·Ø©', 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„', 'Ø§Ù„Ø­Ø§Ù„Ø©', 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª']);
            
            const [year, monthNum] = month.split('-').map(Number);
            const daysInMonth = new Date(year, monthNum, 0).getDate();
            const arabicDays = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${monthNum.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                const dateObj = new Date(dateStr);
                const dayName = arabicDays[dateObj.getDay()];
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
                const attendanceRecord = currentReportData.attendance.find(a => a.date === dateStr);
                let status = 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„';
                let stationName = '';
                let supervisorName = '';
                let notes = '';
                
                if (attendanceRecord) {
                    status = attendanceRecord.status;
                    stationName = attendanceRecord.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    supervisorName = attendanceRecord.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                    
                    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¬Ø§Ø²Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
                    const leaveRecord = currentReportData.leaves.find(l => {
                        const startDate = new Date(l.start);
                        const endDate = new Date(l.end);
                        const currentDate = new Date(dateStr);
                        return currentDate >= startDate && currentDate <= endDate;
                    });
                    
                    if (leaveRecord) {
                        notes = `Ø¥Ø¬Ø§Ø²Ø©: ${leaveRecord.type}`;
                        if (leaveRecord.notes) {
                            notes += ` - ${leaveRecord.notes}`;
                        }
                    }
                }
                
                exportData.push([dayName, dateStr, stationName, supervisorName, status, notes]);
            }
            
            // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„
            const worksheet = XLSX.utils.aoa_to_sheet(exportData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙˆØ¸Ù");
            
            // Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù
            const fileName = `ØªÙ‚Ø±ÙŠØ±_${employeeName}_${month}.xlsx`;
            XLSX.writeFile(workbook, fileName);
            
            alert(`ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­ Ø¨Ø§Ø³Ù…: ${fileName}`);
        }

        // Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙˆØ¸Ù Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
        function sendEmployeeReportWhatsApp() {
            if (!currentReportData) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø±Ø³Ø§Ù„. ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ„Ø§Ù‹.');
                return;
            }
            
            const employee = employees.find(emp => emp.name === currentReportData.employeeName);
            if (!employee) return;
            
            const summary = currentReportData.summary;
            const month = currentReportData.month;
            
            const message = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${employee.name}ØŒ

ØªÙØ§ØµÙŠÙ„ Ø±Ø§ØªØ¨Ùƒ Ù„Ø´Ù‡Ø± ${month}:
- Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: ${employee.salary} Ø¬.Ù…
- Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§: ${employee.workDays} ÙŠÙˆÙ…
- Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±: ${summary.totalPresent} ÙŠÙˆÙ…
${summary.extraDays > 0 ? `- Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©: ${summary.extraDays} ÙŠÙˆÙ…\n- Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©: ${summary.extraSalary.toFixed(2)} Ø¬.Ù…` : ''}
- Ø§Ù„Ø³Ù„Ù: ${summary.totalLoans} Ø¬.Ù…
- Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª: ${summary.totalRewards} Ø¬.Ù…
- Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª: ${summary.totalDeductions} Ø¬.Ù…
- ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨: ${summary.netSalary} Ø¬.Ù…

Ø´ÙƒØ±Ø§Ù‹ Ù„Ø¬Ù‡ÙˆØ¯Ùƒ!`;
            
            const encodedMessage = encodeURIComponent(message);
            const whatsappNumber = employee.whatsapp || employee.phone;
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
            window.open(whatsappUrl, '_blank');
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± ÙŠØ¯ÙˆÙŠ
        function recordManualAttendance() {
            showLoadingState(true);
            
            const employeeName = document.getElementById('attendanceEmployee').value;
            const stationName = document.getElementById('attendanceStation').value;
            const supervisorId = document.getElementById('attendanceSupervisor').value;
            const date = document.getElementById('attendanceDate').value;
            const status = document.getElementById('attendanceStatus').value;
            
            if (!employeeName || !stationName || !supervisorId || !date || !status) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                showLoadingState(false);
                return;
            }
            
            const supervisor = supervisors.find(sup => sup.employeeId === supervisorId);
            
            const existingRecord = attendance.find(record => 
                record.employeeName === employeeName && record.date === date
            );
            
            let promise;
            
            if (existingRecord) {
                promise = updateData('attendance', existingRecord.id, { 
                    status,
                    stationName,
                    supervisorId,
                    supervisorName: supervisor ? supervisor.employeeName : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'
                });
            } else {
                const newAttendance = {
                    employeeName,
                    stationName,
                    supervisorId,
                    supervisorName: supervisor ? supervisor.employeeName : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
                    date,
                    status
                };
                promise = addData('attendance', newAttendance);
            }
            
            promise
                .then(() => {
                    showLoadingState(false);
                    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function recordAutoAttendance() {
            showLoadingState(true);
            
            const today = new Date().toISOString().split('T')[0];
            let recordsAdded = 0;
            let promises = [];
            
            employees.forEach(emp => {
                if (!emp.active) return;
                
                const existingRecord = attendance.find(record => 
                    record.employeeName === emp.name && record.date === today
                );
                
                if (existingRecord) {
                    return;
                }
                
                const isOnLeave = leaves.some(leave => {
                    const startDate = new Date(leave.start);
                    const endDate = new Date(leave.end);
                    const todayDate = new Date(today);
                    
                    return leave.employeeName === emp.name && 
                           todayDate >= startDate && 
                           todayDate <= endDate;
                });
                
                const status = isOnLeave ? 'Ø¥Ø¬Ø§Ø²Ø©' : 'Ø­Ø§Ø¶Ø±';
                
                const newAttendance = {
                    employeeName: emp.name,
                    stationName: '',
                    supervisorId: '',
                    supervisorName: 'ØªÙ„Ù‚Ø§Ø¦ÙŠ',
                    date: today,
                    status: status
                };
                
                promises.push(addData('attendance', newAttendance));
                recordsAdded++;
            });
            
            if (promises.length > 0) {
                Promise.all(promises)
                    .then(() => {
                        showLoadingState(false);
                        alert(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù€ ${recordsAdded} Ù…ÙˆØ¸Ù`);
                        loadAllData();
                    })
                    .catch(error => {
                        showLoadingState(false);
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    });
            } else {
                showLoadingState(false);
                alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…');
            }
        }

        // Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±
        function displayAttendanceList() {
            const container = document.getElementById('attendanceList');
            container.innerHTML = '';
            
            const month = document.getElementById('filterAttendanceMonth').value;
            const stationFilter = document.getElementById('filterAttendanceStation').value;
            
            if (!month) {
                container.innerHTML = '<div class="empty-state">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø´Ù‡Ø± Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</div>';
                return;
            }
            
            let filteredAttendance = attendance.filter(record => record.date.startsWith(month));
            
            if (stationFilter) {
                filteredAttendance = filteredAttendance.filter(record => record.stationName === stationFilter);
            }
            
            const activeEmployees = employees.filter(emp => emp.active);
            
            if (activeEmployees.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù†Ø´Ø·ÙŠÙ†</div>';
                return;
            }
            
            // ØªØ¬Ù…ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ¸Ù
            const employeeStats = {};
            
            filteredAttendance.forEach(record => {
                if (!employeeStats[record.employeeName]) {
                    employeeStats[record.employeeName] = {
                        present: 0,
                        absent: 0,
                        leave: 0,
                        station: record.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
                    };
                }
                
                if (record.status === 'Ø­Ø§Ø¶Ø±') employeeStats[record.employeeName].present++;
                else if (record.status === 'ØºØ§Ø¦Ø¨') employeeStats[record.employeeName].absent++;
                else if (record.status === 'Ø¥Ø¬Ø§Ø²Ø©') employeeStats[record.employeeName].leave++;
            });
            
            for (let [employeeName, stats] of Object.entries(employeeStats)) {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${employeeName}</div>
                        <div class="item-subtitle">
                            <span class="station-badge">${stats.station}</span>
                        </div>
                        <div class="item-subtitle">
                            <span>Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±: ${stats.present}</span>
                            <span>Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©: ${stats.leave}</span>
                            <span>Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨: ${stats.absent}</span>
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="btn-whatsapp" onclick="sendWhatsAppMessage('${employeeName}', '${month}')">
                            <i class="fab fa-whatsapp"></i> Ø¥Ø±Ø³Ø§Ù„
                        </button>
                    </div>
                `;
                container.appendChild(item);
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ø§Ø²Ø©
        function addLeave() {
            showLoadingState(true);
            
            const employeeName = document.getElementById('leaveEmployee').value;
            const stationName = document.getElementById('leaveStation').value;
            const supervisorId = document.getElementById('leaveSupervisor').value;
            const type = document.getElementById('leaveType').value;
            const start = document.getElementById('leaveStart').value;
            const end = document.getElementById('leaveEnd').value;
            const notes = document.getElementById('leaveNotes').value;
            
            if (!employeeName || !stationName || !supervisorId || !type || !start || !end) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                showLoadingState(false);
                return;
            }
            
            const supervisor = supervisors.find(sup => sup.employeeId === supervisorId);
            
            const newLeave = {
                employeeName,
                stationName,
                supervisorId,
                supervisorName: supervisor ? supervisor.employeeName : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
                type,
                start,
                end,
                notes
            };
            
            addData('leaves', newLeave)
                .then(() => {
                    document.getElementById('leaveForm').reset();
                    document.getElementById('leaveStart').value = new Date().toISOString().split('T')[0];
                    document.getElementById('leaveEnd').value = new Date().toISOString().split('T')[0];
                    
                    showLoadingState(false);
                    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© Ù…Ø§Ù„ÙŠØ©
        function addFinancial() {
            showLoadingState(true);
            
            const employeeName = document.getElementById('financialEmployee').value;
            const stationName = document.getElementById('financialStation').value;
            const supervisorId = document.getElementById('financialSupervisor').value;
            const type = document.getElementById('financialType').value;
            const amount = parseInt(document.getElementById('financialAmount').value);
            const date = document.getElementById('financialDate').value;
            const notes = document.getElementById('financialNotes').value;
            
            if (!employeeName || !stationName || !supervisorId || !type || !amount || !date) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                showLoadingState(false);
                return;
            }
            
            const supervisor = supervisors.find(sup => sup.employeeId === supervisorId);
            
            const newFinancial = {
                employeeName,
                stationName,
                supervisorId,
                supervisorName: supervisor ? supervisor.employeeName : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
                type,
                amount,
                date,
                notes
            };
            
            addData('financials', newFinancial)
                .then(() => {
                    document.getElementById('financialForm').reset();
                    document.getElementById('financialDate').value = new Date().toISOString().split('T')[0];
                    
                    showLoadingState(false);
                    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
        function displayFinancialsList() {
            const container = document.getElementById('financialList');
            container.innerHTML = '';
            
            const month = document.getElementById('filterFinancialMonth') ? 
                         document.getElementById('filterFinancialMonth').value : '';
            const stationFilter = document.getElementById('filterFinancialStation') ? 
                              document.getElementById('filterFinancialStation').value : '';
            const typeFilter = document.getElementById('filterFinancialType') ? 
                              document.getElementById('filterFinancialType').value : '';
            
            let filteredFinancials = financials;
            
            if (month) {
                filteredFinancials = filteredFinancials.filter(financial => 
                    financial.date.startsWith(month)
                );
            }
            
            if (stationFilter) {
                filteredFinancials = filteredFinancials.filter(financial => 
                    financial.stationName === stationFilter
                );
            }
            
            if (typeFilter) {
                filteredFinancials = filteredFinancials.filter(financial => 
                    financial.type === typeFilter
                );
            }
            
            if (filteredFinancials.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª Ù…Ø§Ù„ÙŠØ© Ù…Ø³Ø¬Ù„Ø©</div>';
                return;
            }
            
            filteredFinancials.forEach(financial => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${financial.employeeName}</div>
                        <div class="item-subtitle">
                            <span class="station-badge">${financial.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                            <span>${financial.type} - ${financial.amount} Ø¬.Ù…</span>
                        </div>
                        <div class="item-subtitle">
                            <span>${financial.date}</span>
                            <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: ${financial.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editFinancial('${financial.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-delete" onclick="deleteFinancial('${financial.id}')">Ø­Ø°Ù</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© Ù„Ù„Ø¹Ù‡Ø¯Ø©
        function addCashTransaction(type) {
            showLoadingState(true);
            
            let amount, transactionDate, notes, transactionType, category, recipient, supervisorId;
            
            if (type === 'deposit') {
                amount = parseInt(document.getElementById('depositAmount').value);
                transactionDate = document.getElementById('depositDate').value;
                notes = document.getElementById('depositNotes').value;
                category = document.getElementById('depositCategory').value;
                transactionType = 'Ø¥ÙŠØ¯Ø§Ø¹';
                supervisorId = document.getElementById('depositSupervisor').value;
                
                if (!validateAmount(amount, 'depositAmountError') || !supervisorId) {
                    showLoadingState(false);
                    return;
                }
            } else if (type === 'withdrawal') {
                amount = parseInt(document.getElementById('withdrawalAmount').value);
                transactionDate = document.getElementById('withdrawalDate').value;
                notes = document.getElementById('withdrawalNotes').value;
                transactionType = document.getElementById('withdrawalType').value;
                recipient = document.getElementById('withdrawalRecipient').value;
                supervisorId = document.getElementById('withdrawalSupervisor').value;
                
                if (!validateAmount(amount, 'withdrawalAmountError') || !supervisorId) {
                    showLoadingState(false);
                    return;
                }
                
                const currentBalance = calculateCurrentCashBalance();
                if (amount > currentBalance) {
                    alert('Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ØµØ±ÙÙ‡ Ø£ÙƒØ¨Ø± Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ù‡Ø¯Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ');
                    showLoadingState(false);
                    return;
                }
            }
            
            const supervisor = supervisors.find(sup => sup.employeeId === supervisorId);
            
            const newTransaction = {
                type: transactionType,
                amount,
                date: transactionDate,
                notes,
                transactionType: type,
                supervisorId,
                supervisorName: supervisor ? supervisor.employeeName : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'
            };
            
            if (type === 'deposit') {
                newTransaction.category = category;
            } else if (type === 'withdrawal') {
                newTransaction.withdrawalType = transactionType;
                newTransaction.recipient = recipient;
            }
            
            addData('cashTransactions', newTransaction)
                .then(() => {
                    if (type === 'deposit') {
                        document.getElementById('depositForm').reset();
                        document.getElementById('depositDate').value = new Date().toISOString().split('T')[0];
                    } else if (type === 'withdrawal') {
                        document.getElementById('withdrawalForm').reset();
                        document.getElementById('withdrawalDate').value = new Date().toISOString().split('T')[0];
                    }
                    
                    showLoadingState(false);
                    alert(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${type === 'deposit' ? 'Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹' : 'Ø§Ù„ØµØ±Ù'} Ø¨Ù†Ø¬Ø§Ø­`);
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert(`Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ ${type === 'deposit' ? 'Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹' : 'Ø§Ù„ØµØ±Ù'}. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.`);
                });
        }

        // Ø­Ø³Ø§Ø¨ Ø±ØµÙŠØ¯ Ø§Ù„Ø¹Ù‡Ø¯Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ
        function calculateCurrentCashBalance() {
            let balance = 0;
            
            cashTransactions.forEach(transaction => {
                if (transaction.transactionType === 'deposit') {
                    balance += transaction.amount;
                } else if (transaction.transactionType === 'withdrawal') {
                    balance -= transaction.amount;
                }
            });
            
            return balance;
        }

        // Ø¹Ø±Ø¶ Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¹Ù‡Ø¯Ø©
        function displayCashTransactions() {
            const container = document.getElementById('cashList');
            container.innerHTML = '';
            
            const month = document.getElementById('filterCashMonth').value;
            const typeFilter = document.getElementById('filterCashType').value;
            
            let filteredTransactions = cashTransactions;
            if (month) {
                filteredTransactions = filteredTransactions.filter(transaction => 
                    transaction.date.startsWith(month)
                );
            }
            
            if (typeFilter) {
                filteredTransactions = filteredTransactions.filter(transaction => 
                    transaction.transactionType === typeFilter
                );
            }
            
            if (filteredTransactions.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª Ù„Ù„Ø¹Ù‡Ø¯Ø©</div>';
                return;
            }
            
            filteredTransactions.forEach(transaction => {
                const item = document.createElement('div');
                item.className = 'list-item';
                
                const amountClass = transaction.transactionType === 'deposit' ? 'status-present' : 
                                  transaction.transactionType === 'withdrawal' ? 'status-absent' : 'status-leave';
                const amountSign = transaction.transactionType === 'deposit' ? '+' : 
                                  transaction.transactionType === 'withdrawal' ? '-' : 'â†”';
                
                let details = '';
                if (transaction.transactionType === 'deposit') {
                    details = `ÙØ¦Ø©: ${transaction.category}`;
                } else if (transaction.transactionType === 'withdrawal') {
                    details = `Ù†ÙˆØ¹: ${transaction.withdrawalType}`;
                    if (transaction.recipient) {
                        details += ` - Ù…Ø³ØªÙ„Ù…: ${transaction.recipient}`;
                    }
                }
                
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${transaction.type}</div>
                        <div class="item-subtitle">${transaction.date}</div>
                        <div class="item-subtitle">${details}</div>
                        <div class="item-subtitle">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: ${transaction.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                        <div class="item-subtitle">${transaction.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</div>
                    </div>
                    <div class="${amountClass}">
                        ${amountSign} ${transaction.amount} Ø¬.Ù…
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ù‡Ø¯Ø©
        function updateCashStats() {
            let balance = 0;
            let totalDeposits = 0;
            let totalWithdrawals = 0;
            
            cashTransactions.forEach(transaction => {
                if (transaction.transactionType === 'deposit') {
                    balance += transaction.amount;
                    totalDeposits += transaction.amount;
                } else if (transaction.transactionType === 'withdrawal') {
                    balance -= transaction.amount;
                    totalWithdrawals += transaction.amount;
                }
            });
            
            document.getElementById('currentCashBalance').textContent = `${balance} Ø¬.Ù…`;
            document.getElementById('totalDeposits').textContent = `${totalDeposits} Ø¬.Ù…`;
            document.getElementById('totalWithdrawals').textContent = `${totalWithdrawals} Ø¬.Ù…`;
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù„Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
        function updateDatabaseEmployeesDropdown() {
            const dropdown = document.getElementById('selectMultipleEmployees');
            if (!dropdown) return;
            
            dropdown.innerHTML = '';
            
            const inactiveEmployees = employeeDatabase.filter(emp => !emp.active);
            
            if (inactiveEmployees.length === 0) {
                const option = document.createElement('option');
                option.textContent = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…ØªØ§Ø­ÙŠÙ† Ù„Ù„Ø¥Ø¶Ø§ÙØ©';
                option.disabled = true;
                dropdown.appendChild(option);
                return;
            }
            
            inactiveEmployees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = `${emp.name} - ${emp.phone}`;
                dropdown.appendChild(option);
            });
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ø§Ù„Ù…Ø­ØªÙ…Ù„ÙŠÙ†
            updateSupervisorEmployeesDropdown();
        }

        // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ù† Ø§Ù„Ù‡Ø§ØªÙ
        function importContacts() {
            if ('contacts' in navigator && 'select' in navigator.contacts) {
                navigator.contacts.select(['name', 'tel'], { multiple: true })
                    .then(contacts => {
                        if (contacts.length === 0) {
                            alert('Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„');
                            return;
                        }
                        displayContactsPreview(contacts);
                    })
                    .catch(error => {
                        console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„:', error);
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„. Ù‚Ø¯ Ù„Ø§ ØªÙƒÙˆÙ† Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù…ØªØµÙØ­Ùƒ.');
                    });
            } else {
                alert('Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØµÙØ­ Ø­Ø¯ÙŠØ« ÙŠØ¯Ø¹Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø©.');
            }
        }

        // Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
        function displayContactsPreview(contacts) {
            const previewDiv = document.getElementById('contactsPreview');
            const tbody = document.querySelector('#contactsPreviewTable tbody');
            tbody.innerHTML = '';
            
            contacts.forEach(contact => {
                const name = contact.name ? contact.name[0] : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                const phone = contact.tel ? contact.tel[0] : 'ØºÙŠØ± Ù…ØªÙˆÙØ±';
                
                if (phone === 'ØºÙŠØ± Ù…ØªÙˆÙØ±') return;
                
                const isDuplicate = employeeDatabase.some(emp => 
                    emp.name === name || emp.phone === phone
                );
                
                const status = isDuplicate ? 'Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹' : 'Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¶Ø§ÙØ©';
                const statusClass = isDuplicate ? 'status-absent' : 'status-present';
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <input type="checkbox" class="contact-checkbox" ${isDuplicate ? 'disabled' : 'checked'} data-name="${name}" data-phone="${phone}">
                    </td>
                    <td>${name}</td>
                    <td>${phone}</td>
                    <td class="${statusClass}">${status}</td>
                `;
                tbody.appendChild(tr);
            });
            
            previewDiv.style.display = 'block';
        }

        // ØªØ­Ø¯ÙŠØ¯ Ø¬Ù…ÙŠØ¹ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        function selectAllContacts() {
            const checkboxes = document.querySelectorAll('.contact-checkbox:not(:disabled)');
            checkboxes.forEach(checkbox => {
                checkbox.checked = true;
            });
        }

        // Ø¥Ù„ØºØ§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø¬Ù…ÙŠØ¹ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        function deselectAllContacts() {
            const checkboxes = document.querySelectorAll('.contact-checkbox:not(:disabled)');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
        function addSelectedContacts() {
            const selectedContacts = [];
            const checkboxes = document.querySelectorAll('.contact-checkbox:checked:not(:disabled)');
            
            if (checkboxes.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„ Ù„Ù„Ø¥Ø¶Ø§ÙØ©');
                return;
            }
            
            checkboxes.forEach(checkbox => {
                const name = checkbox.getAttribute('data-name');
                const phone = checkbox.getAttribute('data-phone');
                
                selectedContacts.push({
                    name,
                    phone,
                    whatsapp: phone,
                    address: '',
                    active: false
                });
            });
            
            showLoadingState(true);
            
            const promises = selectedContacts.map(contact => 
                addData('employeeDatabase', contact)
            );
            
            Promise.all(promises)
                .then(() => {
                    showLoadingState(false);
                    alert(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${selectedContacts.length} Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­`);
                    document.getElementById('contactsPreview').style.display = 'none';
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }

        // ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Excel
        function downloadTemplate() {
            const templateData = [
                ['Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù', 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ', 'Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨', 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†'],
                ['Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', '01234567890', '01234567890', 'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù…ØµØ±'],
                ['Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ', '01112223344', '01112223344', 'Ø§Ù„Ø¬ÙŠØ²Ø© - Ù…ØµØ±'],
                ['Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯', '01005556677', '01005556677', 'Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© - Ù…ØµØ±']
            ];
            
            const worksheet = XLSX.utils.aoa_to_sheet(templateData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†");
            XLSX.writeFile(workbook, 'Ù†Ù…ÙˆØ°Ø¬_Ø§Ø³ØªÙŠØ±Ø§Ø¯_Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†.xlsx');
        }

        // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
        function previewImport() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel Ø£Ùˆ CSV Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    let jsonData = [];
                    
                    if (file.name.endsWith('.csv')) {
                        jsonData = parseCSV(e.target.result);
                    } else {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                        jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    }
                    
                    if (jsonData.length <= 1) {
                        alert('Ø§Ù„Ù…Ù„Ù Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ ØªÙ†Ø³ÙŠÙ‚Ù‡ ØºÙŠØ± ØµØ­ÙŠØ­');
                        return;
                    }
                    
                    const headers = jsonData[0];
                    const expectedHeaders = ['Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù', 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ', 'Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨', 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†'];
                    let headersValid = true;
                    
                    for (let i = 0; i < expectedHeaders.length; i++) {
                        if (headers[i] !== expectedHeaders[i]) {
                            headersValid = false;
                            break;
                        }
                    }
                    
                    if (!headersValid) {
                        alert('ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø±ÙÙ‚.');
                        return;
                    }
                    
                    const previewTable = document.getElementById('previewTable');
                    const tbody = previewTable.querySelector('tbody');
                    tbody.innerHTML = '';
                    
                    for (let i = 1; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        if (row.length === 0) continue;
                        
                        const tr = document.createElement('tr');
                        for (let j = 0; j < 4; j++) {
                            const td = document.createElement('td');
                            td.textContent = row[j] || '';
                            tr.appendChild(td);
                        }
                        tbody.appendChild(tr);
                    }
                    
                    document.getElementById('importPreview').style.display = 'block';
                    document.getElementById('importStatus').style.display = 'none';
                    
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ù:', error);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                }
            };
            
            if (file.name.endsWith('.csv')) {
                reader.readAsText(file);
            } else {
                reader.readAsArrayBuffer(file);
            }
        }

        // ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù CSV
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const result = [];
            
            for (let i = 0; i < lines.length; i++) {
                if (lines[i].trim() === '') continue;
                const regex = /(?:,|\n|^)(?:"([^"]*(?:""[^"]*)*)"|([^",\n]*))/g;
                let matches;
                const row = [];
                
                while ((matches = regex.exec(lines[i])) !== null) {
                    let value = matches[1] || matches[2];
                    if (value) {
                        value = value.replace(/""/g, '"');
                    }
                    row.push(value || '');
                }
                
                result.push(row);
            }
            
            return result;
        }

        // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† Ù…Ù„Ù Excel Ø£Ùˆ CSV
        function importEmployees() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel Ø£Ùˆ CSV Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    let jsonData = [];
                    
                    if (file.name.endsWith('.csv')) {
                        jsonData = parseCSV(e.target.result);
                    } else {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                        jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    }
                    
                    if (jsonData.length <= 1) {
                        alert('Ø§Ù„Ù…Ù„Ù Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª');
                        return;
                    }
                    
                    const headers = jsonData[0];
                    const expectedHeaders = ['Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù', 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ', 'Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨', 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†'];
                    let headersValid = true;
                    
                    for (let i = 0; i < expectedHeaders.length; i++) {
                        if (headers[i] !== expectedHeaders[i]) {
                            headersValid = false;
                            break;
                        }
                    }
                    
                    if (!headersValid) {
                        alert('ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø±ÙÙ‚.');
                        return;
                    }
                    
                    const employeesToAdd = [];
                    const errors = [];
                    
                    for (let i = 1; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        if (row.length === 0) continue;
                        
                        const name = row[0] ? row[0].toString().trim() : '';
                        const phone = row[1] ? row[1].toString().trim() : '';
                        const whatsapp = row[2] ? row[2].toString().trim() : phone;
                        const address = row[3] ? row[3].toString().trim() : '';
                        
                        if (!name || !phone) {
                            errors.push(`Ø§Ù„ØµÙ ${i+1}: Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†`);
                            continue;
                        }
                        
                        if (!isValidPhone(phone)) {
                            errors.push(`Ø§Ù„ØµÙ ${i+1}: Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ${phone} ØºÙŠØ± ØµØ­ÙŠØ­`);
                            continue;
                        }
                        
                        const isDuplicate = employeeDatabase.some(emp => 
                            emp.name === name || emp.phone === phone
                        );
                        
                        if (isDuplicate) {
                            errors.push(`Ø§Ù„ØµÙ ${i+1}: Ø§Ù„Ù…ÙˆØ¸Ù ${name} Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹`);
                            continue;
                        }
                        
                        employeesToAdd.push({
                            name,
                            phone,
                            whatsapp,
                            address,
                            active: false
                        });
                    }
                    
                    const statusDiv = document.getElementById('importStatus');
                    
                    if (employeesToAdd.length === 0 && errors.length === 0) {
                        statusDiv.innerHTML = '<div class="import-warning">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø© Ù„Ù„Ø¥Ø¶Ø§ÙØ©</div>';
                        statusDiv.style.display = 'block';
                        return;
                    }
                    
                    if (employeesToAdd.length > 0) {
                        showLoadingState(true);
                        
                        const promises = employeesToAdd.map(employee => 
                            addData('employeeDatabase', employee)
                        );
                        
                        Promise.allSettled(promises)
                            .then(results => {
                                showLoadingState(false);
                                
                                const successful = results.filter(r => r.status === 'fulfilled').length;
                                const failed = results.filter(r => r.status === 'rejected').length;
                                
                                let statusMessage = `<div class="import-success">ØªÙ… Ø¥Ø¶Ø§ÙØ© ${successful} Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­</div>`;
                                
                                if (failed > 0) {
                                    statusMessage += `<div class="import-warning">ÙØ´Ù„ ÙÙŠ Ø¥Ø¶Ø§ÙØ© ${failed} Ù…ÙˆØ¸Ù</div>`;
                                }
                                
                                if (errors.length > 0) {
                                    statusMessage += `<div class="import-error"><strong>Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:</strong><ul>`;
                                    errors.forEach(error => {
                                        statusMessage += `<li>${error}</li>`;
                                    });
                                    statusMessage += `</ul></div>`;
                                }
                                
                                statusDiv.innerHTML = statusMessage;
                                statusDiv.style.display = 'block';
                                
                                document.getElementById('importFile').value = '';
                                document.getElementById('importPreview').style.display = 'none';
                                
                                loadAllData();
                            })
                            .catch(error => {
                                showLoadingState(false);
                                statusDiv.innerHTML = `<div class="import-error">Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: ${error.message}</div>`;
                                statusDiv.style.display = 'block';
                            });
                    } else {
                        statusDiv.innerHTML = `<div class="import-error"><strong>Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù…ÙˆØ¸Ù:</strong><ul>`;
                        errors.forEach(error => {
                            statusDiv.innerHTML += `<li>${error}</li>`;
                        });
                        statusDiv.innerHTML += `</ul></div>`;
                        statusDiv.style.display = 'block';
                    }
                    
                } catch (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù:', error);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                }
            };
            
            if (file.name.endsWith('.csv')) {
                reader.readAsText(file);
            } else {
                reader.readAsArrayBuffer(file);
            }
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
        function isValidPhone(phone) {
            const phoneRegex = /^[0-9]{10,15}$/;
            return phoneRegex.test(phone);
        }

        // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
        function importFromDatabase() {
            const selectElement = document.getElementById('selectMultipleEmployees');
            const selectedOptions = Array.from(selectElement.selectedOptions);
            
            if (selectedOptions.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
                return;
            }
            
            const defaultJob = document.getElementById('defaultJob').value;
            const defaultSalary = parseInt(document.getElementById('defaultSalary').value) || 0;
            const defaultWorkDays = parseInt(document.getElementById('defaultWorkDays').value) || 24;
            
            if (!defaultJob) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
                return;
            }
            
            if (defaultSalary <= 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§ØªØ¨ Ø£Ø³Ø§Ø³ÙŠ ØµØ­ÙŠØ­');
                return;
            }
            
            showLoadingState(true);
            
            const promises = selectedOptions.map(option => {
                const employeeId = option.value;
                const employee = employeeDatabase.find(emp => emp.id === employeeId);
                
                if (!employee) {
                    return Promise.reject(`Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${option.textContent}`);
                }
                
                const isAlreadyAdded = employees.some(emp => emp.phone === employee.phone);
                
                if (isAlreadyAdded) {
                    return Promise.reject(`Ø§Ù„Ù…ÙˆØ¸Ù ${employee.name} Ù…Ø¶Ø§Ù Ø¨Ø§Ù„ÙØ¹Ù„`);
                }
                
                const newEmployee = {
                    name: employee.name,
                    phone: employee.phone,
                    job: defaultJob,
                    salary: defaultSalary,
                    workDays: defaultWorkDays,
                    active: true,
                    attendanceDays: 0
                };
                
                return addData('employees', newEmployee)
                    .then(() => {
                        return updateData('employeeDatabase', employeeId, { active: true });
                    });
            });
            
            Promise.allSettled(promises)
                .then(results => {
                    showLoadingState(false);
                    
                    const successful = results.filter(r => r.status === 'fulfilled').length;
                    const failed = results.filter(r => r.status === 'rejected').length;
                    
                    let message = `<div class="import-success">ØªÙ… Ø¥Ø¶Ø§ÙØ© ${successful} Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­</div>`;
                    
                    if (failed > 0) {
                        message += `<div class="import-error"><strong>ÙØ´Ù„ ÙÙŠ Ø¥Ø¶Ø§ÙØ© ${failed} Ù…ÙˆØ¸Ù:</strong><ul>`;
                        results.forEach((result, index) => {
                            if (result.status === 'rejected') {
                                message += `<li>${selectedOptions[index].textContent}: ${result.reason}</li>`;
                            }
                        });
                        message += `</ul></div>`;
                    }
                    
                    document.getElementById('defaultJob').value = '';
                    document.getElementById('defaultSalary').value = '';
                    document.getElementById('defaultWorkDays').value = '24';
                    selectElement.querySelectorAll('option').forEach(option => {
                        option.selected = false;
                    });
                    
                    const statusDiv = document.getElementById('importStatus');
                    statusDiv.innerHTML = message;
                    statusDiv.style.display = 'block';
                    
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    const statusDiv = document.getElementById('importStatus');
                    statusDiv.innerHTML = `<div class="import-error">Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹: ${error.message}</div>`;
                    statusDiv.style.display = 'block';
                });
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù
        function checkEmployeeDuplicate(name, errorElementId) {
            const errorElement = document.getElementById(errorElementId);
            const isDuplicate = employees.some(emp => emp.name === name);
            
            if (isDuplicate) {
                errorElement.style.display = 'block';
                document.getElementById('empName').classList.add('input-error');
                return true;
            } else {
                errorElement.style.display = 'none';
                document.getElementById('empName').classList.remove('input-error');
                return false;
            }
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
        function checkPhoneDuplicate(phone, errorElementId) {
            const errorElement = document.getElementById(errorElementId);
            const isDuplicate = employees.some(emp => emp.phone === phone);
            
            if (isDuplicate) {
                errorElement.style.display = 'block';
                document.getElementById('empPhone').classList.add('input-error');
                return true;
            } else {
                errorElement.style.display = 'none';
                document.getElementById('empPhone').classList.remove('input-error');
                return false;
            }
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function checkEmployeeDatabaseDuplicate(name, errorElementId) {
            const errorElement = document.getElementById(errorElementId);
            const isDuplicate = employeeDatabase.some(emp => emp.name === name);
            
            if (isDuplicate) {
                errorElement.style.display = 'block';
                document.getElementById('dbEmpName').classList.add('input-error');
                return true;
            } else {
                errorElement.style.display = 'none';
                document.getElementById('dbEmpName').classList.remove('input-error');
                return false;
            }
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function checkPhoneDatabaseDuplicate(phone, errorElementId) {
            const errorElement = document.getElementById(errorElementId);
            const isDuplicate = employeeDatabase.some(emp => emp.phone === phone);
            
            if (isDuplicate) {
                errorElement.style.display = 'block';
                document.getElementById('dbEmpPhone').classList.add('input-error');
                return true;
            } else {
                errorElement.style.display = 'none';
                document.getElementById('dbEmpPhone').classList.remove('input-error');
                return false;
            }
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¨Ù„Øº
        function validateAmount(amount, errorElementId) {
            const errorElement = document.getElementById(errorElementId);
            
            if (!amount || amount <= 0) {
                errorElement.style.display = 'block';
                errorElement.textContent = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­';
                return false;
            } else {
                errorElement.style.display = 'none';
                return true;
            }
        }
        
        // ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
        function toggleSideMenu() {
            sideMenu.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
        function showPage(pageId) {
            document.querySelectorAll('.tab-content').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©
            const pageTitles = {
                'dashboard': 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…',
                'employees': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                'employee-database': 'Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                'attendance': 'Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨',
                'leaves': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª',
                'employee-records': 'Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                'financial': 'Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª',
                'reports': 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª',
                'cash': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‡Ø¯Ø©',
                'faults': 'Ø³Ø¬Ù„ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„',
                'stations': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø·Ø§Øª',
                'supervisors': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†',
                'settings': 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª',
                'backup': 'Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ'
            };
            document.getElementById('pageTitle').textContent = pageTitles[pageId];
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø©
            if (pageId === 'dashboard') updateDashboard();
            else if (pageId === 'employees') {
                displayEmployeesList();
                updateDatabaseEmployeesDropdown();
            }
            else if (pageId === 'employee-database') displayEmployeeDatabase();
            else if (pageId === 'attendance') displayAttendanceList();
            else if (pageId === 'leaves') displayLeavesList();
            else if (pageId === 'employee-records') {
                updateEmployeesDropdowns();
                document.getElementById('employeeReportContainer').style.display = 'none';
            }
            else if (pageId === 'financial') displayFinancialsList();
            else if (pageId === 'reports') generateSalaryReport();
            else if (pageId === 'cash') {
                displayCashTransactions();
                updateCashStats();
            }
            else if (pageId === 'faults') displayFaultsList();
            else if (pageId === 'stations') displayStationsList();
            else if (pageId === 'supervisors') {
                displaySupervisorsList();
                updateSupervisorEmployeesDropdown();
            }
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯
        function addEmployee() {
            showLoadingState(true);
            
            const name = document.getElementById('empName').value;
            const phone = document.getElementById('empPhone').value;
            const job = document.getElementById('empJob').value;
            const salary = parseInt(document.getElementById('empSalary').value);
            const workDays = parseInt(document.getElementById('empWorkDays').value);
            const active = document.getElementById('empActive').value === 'true';
            
            const existingEmployee = employeeDatabase.find(emp => 
                emp.name === name || emp.phone === phone
            );
            
            if (!existingEmployee) {
                showLoadingState(false);
                alert('ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø£ÙˆÙ„Ø§Ù‹ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØªÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†');
                showPage('employee-database');
                return;
            }
            
            if (checkEmployeeDuplicate(name, 'empNameError') || checkPhoneDuplicate(phone, 'empPhoneError')) {
                showLoadingState(false);
                alert('ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸Ù Ù…Ø³Ø¬Ù„ Ø¨Ù†ÙØ³ Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ');
                return;
            }
            
            const newEmployee = {
                name,
                phone,
                job,
                salary,
                workDays,
                active,
                attendanceDays: 0,
                address: existingEmployee.address || '',
                whatsapp: existingEmployee.whatsapp || phone
            };
            
            addData('employees', newEmployee)
                .then((addedEmployee) => {
                    updateData('employeeDatabase', existingEmployee.id, { active: true })
                    .then(() => {
                        document.getElementById('employeeForm').reset();
                        document.getElementById('empWorkDays').value = 24;
                        document.getElementById('empActive').value = 'true';
                        
                        showLoadingState(false);
                        alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        showLoadingState(false);
                        alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸ÙØŒ ÙˆÙ„ÙƒÙ† Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                        loadAllData();
                    });
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function addEmployeeToDatabase() {
            showLoadingState(true);
            
            const name = document.getElementById('dbEmpName').value;
            const phone = document.getElementById('dbEmpPhone').value;
            const whatsapp = document.getElementById('dbEmpWhatsapp').value || phone;
            const address = document.getElementById('dbEmpAddress').value;
            
            if (checkEmployeeDatabaseDuplicate(name, 'dbEmpNameError') || checkPhoneDatabaseDuplicate(phone, 'dbEmpPhoneError')) {
                showLoadingState(false);
                alert('ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸Ù Ù…Ø³Ø¬Ù„ Ø¨Ù†ÙØ³ Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ');
                return;
            }
            
            const newEmployee = {
                name,
                phone,
                whatsapp,
                address,
                job: '',
                salary: 0,
                workDays: 24,
                active: false,
                attendanceDays: 0
            };
            
            addData('employeeDatabase', newEmployee)
                .then(() => {
                    document.getElementById('employeeDatabaseForm').reset();
                    
                    showLoadingState(false);
                    alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }
        
        // Ù†Ù‚Ù„ Ù…ÙˆØ¸Ù Ù…Ø¹Ø·Ù„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function moveEmployeeToDatabase(employee) {
            const existingEmployee = employeeDatabase.find(emp => emp.phone === employee.phone);
            
            if (existingEmployee) {
                updateData('employeeDatabase', existingEmployee.id, {
                    name: employee.name,
                    phone: employee.phone,
                    whatsapp: employee.whatsapp || employee.phone,
                    job: employee.job,
                    address: employee.address || '',
                    active: false
                })
                .then(() => {
                    deleteData('employees', employee.id)
                    .then(() => {
                        alert('ØªÙ… Ù†Ù‚Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù†Ù‚Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                    });
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                });
            } else {
                const newEmployeeData = {
                    name: employee.name,
                    phone: employee.phone,
                    whatsapp: employee.whatsapp || employee.phone,
                    job: employee.job,
                    address: employee.address || '',
                    salary: employee.salary,
                    workDays: employee.workDays,
                    active: false
                };
                
                addData('employeeDatabase', newEmployeeData)
                .then(() => {
                    deleteData('employees', employee.id)
                    .then(() => {
                        alert('ØªÙ… Ù†Ù‚Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù†Ù‚Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                    });
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                });
            }
        }
        
        // Ù†Ù‚Ù„ Ù…ÙˆØ¸Ù Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
        function moveEmployeeFromDatabase(employee) {
            const existingEmployee = employees.find(emp => emp.phone === employee.phone);
            
            if (existingEmployee) {
                alert('Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸Ù Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†');
                return;
            }
            
            const newEmployeeData = {
                name: employee.name,
                phone: employee.phone,
                job: employee.job || '',
                salary: employee.salary || 0,
                workDays: employee.workDays || 24,
                active: true,
                attendanceDays: 0
            };
            
            addData('employees', newEmployeeData)
            .then(() => {
                updateData('employeeDatabase', employee.id, { active: true })
                .then(() => {
                    alert('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                });
            })
            .catch(error => {
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†');
            });
        }
        
        // ØªÙØ¹ÙŠÙ„ Ù…ÙˆØ¸Ù Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function activateEmployeeFromDatabase(id) {
            const employee = employeeDatabase.find(emp => emp.id === id);
            if (!employee) return;
            moveEmployeeFromDatabase(employee);
        }
        
        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function displayEmployeesList() {
            const container = document.getElementById('employeesList');
            container.innerHTML = '';
            
            if (employees.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†</div>';
                return;
            }
            
            employees.forEach(emp => {
                const item = document.createElement('div');
                item.className = 'list-item';
                
                const statusClass = emp.active ? 'status-active' : 'status-inactive';
                const statusText = emp.active ? 'ÙØ¹Ø§Ù„' : 'ØºÙŠØ± ÙØ¹Ø§Ù„';
                
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${emp.name}</div>
                        <div class="item-subtitle">${emp.job} - ${emp.salary} Ø¬.Ù… - ${emp.workDays} ÙŠÙˆÙ… Ø¹Ù…Ù„</div>
                        <div class="employee-status ${statusClass}">${statusText}</div>
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" onclick="editEmployee('${emp.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                        ${emp.active ? 
                            `<button class="btn-deactivate" onclick="toggleEmployeeStatus('${emp.id}')">ØªØ¹Ø·ÙŠÙ„</button>` : 
                            `<button class="btn-activate" onclick="toggleEmployeeStatus('${emp.id}')">ØªÙØ¹ÙŠÙ„</button>`
                        }
                        <button class="btn-delete" onclick="deleteEmployee('${emp.id}')">Ø­Ø°Ù</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }
        
        // ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù
        function toggleEmployeeStatus(id) {
            const employee = employees.find(emp => emp.id === id);
            if (!employee) return;
            
            const newStatus = !employee.active;
            
            if (newStatus) {
                updateData('employees', id, { active: newStatus })
                .then(() => {
                    alert('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
            } else {
                if (confirm('Ø³ÙŠØªÙ… ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù ÙˆÙ†Ù‚Ù„Ù‡ Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ')) {
                    moveEmployeeToDatabase(employee);
                }
            }
        }
        
        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function displayEmployeeDatabase() {
            const container = document.getElementById('employeeDatabaseList');
            container.innerHTML = '';
            
            const searchTerm = document.getElementById('searchEmployee').value.toLowerCase();
            
            const filteredEmployees = employeeDatabase.filter(emp => 
                emp.name.toLowerCase().includes(searchTerm) || 
                emp.phone.includes(searchTerm)
            );
            
            if (filteredEmployees.length === 0) {
                container.innerHTML = '<div class="empty-state">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†</div>';
                return;
            }
            
            filteredEmployees.forEach(emp => {
                const card = document.createElement('div');
                card.className = 'employee-details-card';
                
                card.innerHTML = `
                    <div class="employee-details-header">
                        ${emp.name}
                        <div class="employee-status ${emp.active ? 'status-active' : 'status-inactive'}">${emp.active ? 'Ù…ÙØ¹Ù„' : 'ØºÙŠØ± Ù…ÙØ¹Ù„'}</div>
                    </div>
                    <div class="employee-details-body">
                        <div class="employee-info-grid">
                            <div class="info-item">
                                <span class="info-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</span>
                                <span class="info-value">${emp.phone}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨:</span>
                                <span class="info-value">${emp.whatsapp || emp.phone}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span>
                                <span class="info-value">${emp.address || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                            </div>
                        </div>
                        <div class="employee-actions">
                            <button class="btn-call" onclick="callEmployee('${emp.phone}')">
                                <i class="fas fa-phone"></i> Ø§ØªØµÙ„
                            </button>
                            <button class="btn-whatsapp" onclick="sendWhatsAppToEmployee('${emp.whatsapp || emp.phone}')">
                                <i class="fab fa-whatsapp"></i> ÙˆØ§ØªØ³Ø§Ø¨
                            </button>
                            ${!emp.active ? 
                                `<button class="btn-activate" onclick="activateEmployeeFromDatabase('${emp.id}')">ØªÙØ¹ÙŠÙ„</button>` : 
                                `<button class="btn-success" disabled>Ù…ÙØ¹Ù„</button>`
                            }
                            <button class="btn-edit" onclick="editEmployeeInDatabase('${emp.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                            <button class="btn-delete" onclick="deleteEmployeeFromDatabase('${emp.id}')">Ø­Ø°Ù</button>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…ÙˆØ¸Ù
        function callEmployee(phone) {
            window.open(`tel:${phone}`, '_self');
        }
        
        // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ù…ÙˆØ¸Ù
        function sendWhatsAppToEmployee(phone) {
            const message = "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£ÙˆØ¯ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø¹Ù…Ù„";
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${phone}?text=${encodedMessage}`;
            window.open(whatsappUrl, '_blank');
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function editEmployeeInDatabase(id) {
            const employee = employeeDatabase.find(emp => emp.id === id);
            if (!employee) return;
            
            const newName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù:', employee.name);
            if (newName !== null) {
                employee.name = newName;
            }
            
            const newPhone = prompt('Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:', employee.phone);
            if (newPhone !== null) {
                employee.phone = newPhone;
            }
            
            const newWhatsapp = prompt('Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨:', employee.whatsapp || employee.phone);
            if (newWhatsapp !== null) {
                employee.whatsapp = newWhatsapp;
            }
            
            const newAddress = prompt('Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ¸Ù:', employee.address || '');
            if (newAddress !== null) {
                employee.address = newAddress;
            }
            
            updateData('employeeDatabase', id, employee)
                .then(() => {
                    alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }
        
        // Ø­Ø°Ù Ù…ÙˆØ¸Ù Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function deleteEmployeeFromDatabase(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸Ù Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                deleteData('employeeDatabase', id)
                    .then(() => {
                        alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    });
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª
        function generateSalaryReport() {
            showLoadingState(true);
            
            const tbody = document.querySelector('#salaryReportTable tbody');
            tbody.innerHTML = '';
            
            const month = document.getElementById('reportMonth').value;
            
            if (!month) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø´Ù‡Ø±');
                showLoadingState(false);
                return;
            }
            
            if (employees.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§</td></tr>';
                showLoadingState(false);
                return;
            }
            
            employees.forEach(emp => {
                const workDays = attendance.filter(record => 
                    record.employeeName === emp.name && 
                    record.date.startsWith(month) && 
                    record.status === 'Ø­Ø§Ø¶Ø±'
                ).length;
                
                const dailyRate = emp.salary / 30;
                let netSalary = 0;
                
                if (workDays >= emp.workDays) {
                    netSalary = emp.salary;
                    
                    if (workDays > emp.workDays) {
                        const extraDays = workDays - emp.workDays;
                        netSalary += extraDays * dailyRate;
                    }
                } else {
                    netSalary = workDays * dailyRate;
                }
                
                const employeeFinancials = financials.filter(f => 
                    f.employeeName === emp.name && f.date.startsWith(month)
                );
                
                const loans = employeeFinancials
                    .filter(f => f.type === 'Ø³Ù„ÙØ©')
                    .reduce((sum, f) => sum + f.amount, 0);
                
                const rewards = employeeFinancials
                    .filter(f => f.type === 'Ù…ÙƒØ§ÙØ£Ø©')
                    .reduce((sum, f) => sum + f.amount, 0);
                
                const deductions = employeeFinancials
                    .filter(f => f.type === 'Ø®ØµÙ…')
                    .reduce((sum, f) => sum + f.amount, 0);
                
                netSalary = netSalary + rewards - loans - deductions;
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${emp.name}</td>
                    <td>${emp.salary} Ø¬.Ù…</td>
                    <td>${workDays} ÙŠÙˆÙ…</td>
                    <td>${Math.round(netSalary)} Ø¬.Ù…</td>
                    <td>
                        <button class="btn-success" onclick="showSalaryDetails('${emp.name}', '${month}')">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
                        <button class="btn-whatsapp" onclick="sendWhatsAppMessage('${emp.name}', '${month}')" style="margin-top: 5px;">
                            <i class="fab fa-whatsapp"></i> Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
            
            showLoadingState(false);
        }
        
        // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø§ØªØ¨
        function showSalaryDetails(employeeName, month) {
            const emp = employees.find(e => e.name === employeeName);
            if (!emp) return;
            
            const workDays = attendance.filter(record => 
                record.employeeName === emp.name && 
                record.date.startsWith(month) && 
                record.status === 'Ø­Ø§Ø¶Ø±'
            ).length;
            
            const dailyRate = emp.salary / 30;
            let netSalary = 0;
            let extraDays = 0;
            let extraSalary = 0;
            let baseSalary = 0;
            
            if (workDays >= emp.workDays) {
                baseSalary = emp.salary;
                
                if (workDays > emp.workDays) {
                    extraDays = workDays - emp.workDays;
                    extraSalary = extraDays * dailyRate;
                    netSalary = baseSalary + extraSalary;
                } else {
                    netSalary = baseSalary;
                }
            } else {
                baseSalary = workDays * dailyRate;
                netSalary = baseSalary;
            }
            
            const employeeFinancials = financials.filter(f => 
                f.employeeName === emp.name && f.date.startsWith(month)
            );
            
            const loans = employeeFinancials
                .filter(f => f.type === 'Ø³Ù„ÙØ©')
                .reduce((sum, f) => sum + f.amount, 0);
            
            const rewards = employeeFinancials
                .filter(f => f.type === 'Ù…ÙƒØ§ÙØ£Ø©')
                .reduce((sum, f) => sum + f.amount, 0);
            
            const deductions = employeeFinancials
                .filter(f => f.type === 'Ø®ØµÙ…')
                .reduce((sum, f) => sum + f.amount, 0);
            
            netSalary = netSalary + rewards - loans - deductions;
            
            const details = `
                <strong>ØªÙØ§ØµÙŠÙ„ Ø±Ø§ØªØ¨ ${emp.name} Ù„Ø´Ù‡Ø± ${month}</strong><br>
                - Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡: ${emp.salary} Ø¬.Ù…<br>
                - Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§: ${emp.workDays} ÙŠÙˆÙ…<br>
                - Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙØ¹Ù„ÙŠØ©: ${workDays} ÙŠÙˆÙ…<br>
                - Ø³Ø¹Ø± Ø§Ù„ÙŠÙˆÙ…: ${dailyRate.toFixed(2)} Ø¬.Ù…<br>
                ${workDays > emp.workDays ? `- Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©: ${extraDays} ÙŠÙˆÙ…<br>- Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©: ${extraSalary.toFixed(2)} Ø¬.Ù…<br>` : ''}
                - Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚: ${baseSalary.toFixed(2)} Ø¬.Ù…<br>
                - Ø§Ù„Ø³Ù„Ù: ${loans} Ø¬.Ù…<br>
                - Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª: ${rewards} Ø¬.Ù…<br>
                - Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª: ${deductions} Ø¬.Ù…<br>
                - <strong>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨: ${Math.round(netSalary)} Ø¬.Ù…</strong>
            `;
            
            alert(details);
        }
        
        // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ù…ÙˆØ¸Ù
        function sendWhatsAppMessage(employeeName, month) {
            const emp = employees.find(e => e.name === employeeName);
            if (!emp) return;
            
            const workDays = attendance.filter(record => 
                record.employeeName === emp.name && 
                record.date.startsWith(month) && 
                record.status === 'Ø­Ø§Ø¶Ø±'
            ).length;
            
            const dailyRate = emp.salary / 30;
            let netSalary = 0;
            let extraDays = 0;
            let extraSalary = 0;
            let baseSalary = 0;
            
            if (workDays >= emp.workDays) {
                baseSalary = emp.salary;
                
                if (workDays > emp.workDays) {
                    extraDays = workDays - emp.workDays;
                    extraSalary = extraDays * dailyRate;
                    netSalary = baseSalary + extraSalary;
                } else {
                    netSalary = baseSalary;
                }
            } else {
                baseSalary = workDays * dailyRate;
                netSalary = baseSalary;
            }
            
            const employeeFinancials = financials.filter(f => 
                f.employeeName === emp.name && f.date.startsWith(month)
            );
            
            const loans = employeeFinancials
                .filter(f => f.type === 'Ø³Ù„ÙØ©')
                .reduce((sum, f) => sum + f.amount, 0);
            
            const rewards = employeeFinancials
                .filter(f => f.type === 'Ù…ÙƒØ§ÙØ£Ø©')
                .reduce((sum, f) => sum + f.amount, 0);
            
            const deductions = employeeFinancials
                .filter(f => f.type === 'Ø®ØµÙ…')
                .reduce((sum, f) => sum + f.amount, 0);
            
            netSalary = netSalary + rewards - loans - deductions;
            
            const message = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${emp.name}ØŒ

ØªÙØ§ØµÙŠÙ„ Ø±Ø§ØªØ¨Ùƒ Ù„Ø´Ù‡Ø± ${month}:
- Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: ${emp.salary} Ø¬.Ù…
- Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§: ${emp.workDays} ÙŠÙˆÙ…
- Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙØ¹Ù„ÙŠØ©: ${workDays} ÙŠÙˆÙ…
${extraDays > 0 ? `- Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©: ${extraDays} ÙŠÙˆÙ…\n- Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©: ${extraSalary.toFixed(2)} Ø¬.Ù…` : ''}
- Ø§Ù„Ø³Ù„Ù: ${loans} Ø¬.Ù…
- Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª: ${rewards} Ø¬.Ù…
- Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª: ${deductions} Ø¬.Ù…
- ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨: ${Math.round(netSalary)} Ø¬.Ù…

Ø´ÙƒØ±Ø§Ù‹ Ù„Ø¬Ù‡ÙˆØ¯Ùƒ!`;
            
            const encodedMessage = encodeURIComponent(message);
            const whatsappNumber = emp.whatsapp || emp.phone;
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
            window.open(whatsappUrl, '_blank');
        }
        
        // Ø­Ø°Ù Ù…ÙˆØ¸Ù
        function deleteEmployee(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸ÙØŸ')) {
                const employee = employees.find(emp => emp.id === id);
                if (!employee) return;
                
                const employeeName = employee.name;
                
                if (confirm(`Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù ÙˆØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© (Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§ØªØŒ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©). Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ`)) {
                    deleteData('employees', id)
                        .then(() => {
                            const attendancePromises = attendance
                                .filter(record => record.employeeName === employeeName)
                                .map(record => deleteData('attendance', record.id));
                            
                            const leavesPromises = leaves
                                .filter(leave => leave.employeeName === employeeName)
                                .map(leave => deleteData('leaves', leave.id));
                            
                            const financialsPromises = financials
                                .filter(financial => financial.employeeName === employeeName)
                                .map(financial => deleteData('financials', financial.id));
                            
                            Promise.all([
                                ...attendancePromises,
                                ...leavesPromises,
                                ...financialsPromises
                            ]).then(() => {
                                alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù ÙˆØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù†Ø¬Ø§Ø­');
                                loadAllData();
                            }).catch(error => {
                                console.error('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©:', error);
                                alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸ÙØŒ ÙˆÙ„ÙƒÙ† Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø¨Ø¹Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©');
                                loadAllData();
                            });
                        })
                        .catch(error => {
                            alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                        });
                }
            }
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¸Ù
        function editEmployee(id) {
            const employee = employees.find(emp => emp.id === id);
            if (!employee) return;
            
            document.getElementById('empName').value = employee.name;
            document.getElementById('empPhone').value = employee.phone;
            document.getElementById('empJob').value = employee.job;
            document.getElementById('empSalary').value = employee.salary;
            document.getElementById('empWorkDays').value = employee.workDays;
            document.getElementById('empActive').value = employee.active.toString();
            
            deleteData('employees', id)
                .then(() => {
                    alert('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù ÙˆØ¥Ø¶Ø§ÙØªÙ‡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                    showPage('employees');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±
        function editAttendance(employeeName, date) {
            const record = attendance.find(r => r.employeeName === employeeName && r.date === date);
            if (!record) return;
            
            document.getElementById('attendanceEmployee').value = employeeName;
            document.getElementById('attendanceDate').value = date;
            document.getElementById('attendanceStatus').value = record.status;
            
            deleteData('attendance', record.id)
                .then(() => {
                    alert('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØªØ³Ø¬ÙŠÙ„Ù‡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                    showPage('attendance');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¶ÙŠØ± Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }
        
        // Ø­Ø°Ù Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±
        function deleteAttendance(employeeName, date) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ØŸ')) {
                const record = attendance.find(r => r.employeeName === employeeName && r.date === date);
                if (!record) return;
                
                deleteData('attendance', record.id)
                    .then(() => {
                        alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    });
            }
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¬Ø§Ø²Ø©
        function editLeave(id) {
            const leave = leaves.find(l => l.id === id);
            if (!leave) return;
            
            document.getElementById('leaveEmployee').value = leave.employeeName;
            document.getElementById('leaveType').value = leave.type;
            document.getElementById('leaveStart').value = leave.start;
            document.getElementById('leaveEnd').value = leave.end;
            document.getElementById('leaveNotes').value = leave.notes;
            
            deleteData('leaves', id)
                .then(() => {
                    alert('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© ÙˆØªØ³Ø¬ÙŠÙ„Ù‡Ø§ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                    showPage('leaves');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }
        
        // Ø­Ø°Ù Ø¥Ø¬Ø§Ø²Ø©
        function deleteLeave(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©ØŸ')) {
                deleteData('leaves', id)
                    .then(() => {
                        alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    });
            }
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø­Ø±ÙƒØ© Ù…Ø§Ù„ÙŠØ©
        function editFinancial(id) {
            const financial = financials.find(f => f.id === id);
            if (!financial) return;
            
            document.getElementById('financialEmployee').value = financial.employeeName;
            document.getElementById('financialType').value = financial.type;
            document.getElementById('financialAmount').value = financial.amount;
            document.getElementById('financialDate').value = financial.date;
            document.getElementById('financialNotes').value = financial.notes;
            
            deleteData('financials', id)
                .then(() => {
                    alert('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØªØ³Ø¬ÙŠÙ„Ù‡Ø§ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
                    showPage('financial');
                    loadAllData();
                })
                .catch(error => {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        }
        
        // Ø­Ø°Ù Ø­Ø±ÙƒØ© Ù…Ø§Ù„ÙŠØ©
        function deleteFinancial(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©ØŸ')) {
                deleteData('financials', id)
                    .then(() => {
                        alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
                        loadAllData();
                    })
                    .catch(error => {
                        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    });
            }
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
        function downloadBackup() {
            const backupData = {
                employees: employees,
                attendance: attendance,
                leaves: leaves,
                financials: financials,
                employeeDatabase: employeeDatabase,
                cashTransactions: cashTransactions,
                stations: stations,
                supervisors: supervisors,
                faults: faults,
                backupDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(backupData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `attendance_backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
        }
        
        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
        function restoreBackup() {
            const fileInput = document.getElementById('backupFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    if (!backupData.employees || !backupData.attendance || !backupData.leaves || !backupData.financials) {
                        alert('Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØºÙŠØ± ØµØ§Ù„Ø­');
                        return;
                    }
                    
                    if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©ØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.')) {
                        showLoadingState(true);
                        
                        Promise.all([
                            saveData('employees', backupData.employees),
                            saveData('attendance', backupData.attendance),
                            saveData('leaves', backupData.leaves),
                            saveData('financials', backupData.financials),
                            saveData('employeeDatabase', backupData.employeeDatabase || []),
                            saveData('cashTransactions', backupData.cashTransactions || []),
                            saveData('stations', backupData.stations || []),
                            saveData('supervisors', backupData.supervisors || []),
                            saveData('faults', backupData.faults || [])
                        ]).then(() => {
                            showLoadingState(false);
                            alert('ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
                            showPage('dashboard');
                            loadAllData();
                        }).catch(error => {
                            showLoadingState(false);
                            alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                        });
                    }
                } catch (error) {
                    console.error(error);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù.');
                }
            };
            reader.readAsText(file);
        }
        
        // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function deleteAllData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
                showLoadingState(true);
                
                Promise.all([
                    saveData('employees', []),
                    saveData('attendance', []),
                    saveData('leaves', []),
                    saveData('financials', []),
                    saveData('employeeDatabase', []),
                    saveData('cashTransactions', []),
                    saveData('stations', []),
                    saveData('supervisors', []),
                    saveData('faults', [])
                ]).then(() => {
                    showLoadingState(false);
                    alert('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                    showPage('dashboard');
                    loadAllData();
                }).catch(error => {
                    showLoadingState(false);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
            }
        }
        
        // ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function exportAllData() {
            const data = {
                Ø§Ù„Ù…ÙˆØ¸ÙÙˆÙ†: employees,
                Ø§Ù„Ø­Ø¶ÙˆØ±: attendance,
                Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª: leaves,
                Ø§Ù„Ø­Ø±ÙƒØ§Øª_Ø§Ù„Ù…Ø§Ù„ÙŠØ©: financials,
                Ù‚Ø§Ø¹Ø¯Ø©_Ø¨ÙŠØ§Ù†Ø§Øª_Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: employeeDatabase,
                Ø­Ø±ÙƒØ§Øª_Ø§Ù„Ø¹Ù‡Ø¯Ø©: cashTransactions,
                Ø§Ù„Ù…Ø­Ø·Ø§Øª: stations,
                Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙˆÙ†: supervisors,
                Ø§Ù„Ø£Ø¹Ø·Ø§Ù„: faults
            };
            
            exportToExcel(data, 'Ø¬Ù…ÙŠØ¹_Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }
        
        // ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function exportEmployeesToExcel() {
            const data = employees.map(emp => ({
                'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù': emp.name,
                'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ': emp.phone,
                'Ø§Ù„ÙˆØ¸ÙŠÙØ©': emp.job,
                'Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø¬.Ù…)': emp.salary,
                'Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§': emp.workDays,
                'Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙØ¹Ù„ÙŠØ©': emp.attendanceDays,
                'Ø§Ù„Ø­Ø§Ù„Ø©': emp.active ? 'ÙØ¹Ø§Ù„' : 'ØºÙŠØ± ÙØ¹Ø§Ù„'
            }));
            
            exportToExcel(data, 'Ø¨ÙŠØ§Ù†Ø§Øª_Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†');
        }
        
        // ØªØµØ¯ÙŠØ± Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
        function exportEmployeeDatabaseToExcel() {
            const data = employeeDatabase.map(emp => ({
                'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù': emp.name,
                'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ': emp.phone,
                'Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨': emp.whatsapp || emp.phone,
                'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†': emp.address || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                'Ø§Ù„Ø­Ø§Ù„Ø©': emp.active ? 'Ù…ÙØ¹Ù„' : 'ØºÙŠØ± Ù…ÙØ¹Ù„'
            }));
            
            exportToExcel(data, 'Ù‚Ø§Ø¹Ø¯Ø©_Ø¨ÙŠØ§Ù†Ø§Øª_Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†');
        }
        
        // ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±
        function exportAttendanceToExcel() {
            const month = document.getElementById('filterAttendanceMonth').value;
            const stationFilter = document.getElementById('filterAttendanceStation').value;
            
            let filteredAttendance = attendance.filter(record => record.date.startsWith(month));
            
            if (stationFilter) {
                filteredAttendance = filteredAttendance.filter(record => record.stationName === stationFilter);
            }
            
            const data = filteredAttendance.map(record => ({
                'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù': record.employeeName,
                'Ø§Ù„Ù…Ø­Ø·Ø©': record.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„': record.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                'Ø§Ù„ØªØ§Ø±ÙŠØ®': record.date,
                'Ø§Ù„Ø­Ø§Ù„Ø©': record.status
            }));
            
            exportToExcel(data, 'Ø³Ø¬Ù„_Ø§Ù„Ø­Ø¶ÙˆØ±');
        }
        
        // ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
        function exportLeavesToExcel() {
            const data = leaves.map(leave => {
                const startDate = new Date(leave.start);
                const endDate = new Date(leave.end);
                const duration = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
                
                return {
                    'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù': leave.employeeName,
                    'Ø§Ù„Ù…Ø­Ø·Ø©': leave.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„': leave.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    'Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©': leave.type,
                    'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡': leave.start,
                    'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡': leave.end,
                    'Ø§Ù„Ù…Ø¯Ø© (Ø£ÙŠØ§Ù…)': duration,
                    'Ù…Ù„Ø§Ø­Ø¸Ø§Øª': leave.notes
                };
            });
            
            exportToExcel(data, 'Ø³Ø¬Ù„_Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª');
        }
        
        // ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
        function exportFinancialsToExcel() {
            const month = document.getElementById('filterFinancialMonth') ? 
                         document.getElementById('filterFinancialMonth').value : '';
            const stationFilter = document.getElementById('filterFinancialStation') ? 
                              document.getElementById('filterFinancialStation').value : '';
            const typeFilter = document.getElementById('filterFinancialType') ? 
                              document.getElementById('filterFinancialType').value : '';
            
            let filteredFinancials = financials;
            
            if (month) {
                filteredFinancials = filteredFinancials.filter(financial => 
                    financial.date.startsWith(month)
                );
            }
            
            if (stationFilter) {
                filteredFinancials = filteredFinancials.filter(financial => 
                    financial.stationName === stationFilter
                );
            }
            
            if (typeFilter) {
                filteredFinancials = filteredFinancials.filter(financial => 
                    financial.type === typeFilter
                );
            }
            
            const data = filteredFinancials.map(financial => ({
                'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù': financial.employeeName,
                'Ø§Ù„Ù…Ø­Ø·Ø©': financial.stationName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„': financial.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                'Ø§Ù„Ù†ÙˆØ¹': financial.type,
                'Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬.Ù…)': financial.amount,
                'Ø§Ù„ØªØ§Ø±ÙŠØ®': financial.date,
                'Ù…Ù„Ø§Ø­Ø¸Ø§Øª': financial.notes
            }));
            
            exportToExcel(data, 'Ø§Ù„Ø­Ø±ÙƒØ§Øª_Ø§Ù„Ù…Ø§Ù„ÙŠØ©');
        }
        
        // ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª
        function exportReportToExcel() {
            const month = document.getElementById('reportMonth').value;
            const data = [];
            
            employees.forEach(emp => {
                const workDays = attendance.filter(record => 
                    record.employeeName === emp.name && 
                    record.date.startsWith(month) && 
                    record.status === 'Ø­Ø§Ø¶Ø±'
                ).length;
                
                const dailyRate = emp.salary / 30;
                let netSalary = 0;
                let extraDays = 0;
                let extraSalary = 0;
                
                if (workDays >= emp.workDays) {
                    netSalary = emp.salary;
                    
                    if (workDays > emp.workDays) {
                        extraDays = workDays - emp.workDays;
                        extraSalary = extraDays * dailyRate;
                        netSalary += extraSalary;
                    }
                } else {
                    netSalary = workDays * dailyRate;
                }
                
                const employeeFinancials = financials.filter(f => 
                    f.employeeName === emp.name && f.date.startsWith(month)
                );
                
                const loans = employeeFinancials
                    .filter(f => f.type === 'Ø³Ù„ÙØ©')
                    .reduce((sum, f) => sum + f.amount, 0);
                
                const rewards = employeeFinancials
                    .filter(f => f.type === 'Ù…ÙƒØ§ÙØ£Ø©')
                    .reduce((sum, f) => sum + f.amount, 0);
                
                const deductions = employeeFinancials
                    .filter(f => f.type === 'Ø®ØµÙ…')
                    .reduce((sum, f) => sum + f.amount, 0);
                
                netSalary = netSalary + rewards - loans - deductions;
                
                data.push({
                    'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù': emp.name,
                    'Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø¬.Ù…)': emp.salary,
                    'Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§': emp.workDays,
                    'Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙØ¹Ù„ÙŠØ©': workDays,
                    'Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©': extraDays,
                    'Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© (Ø¬.Ù…)': extraSalary.toFixed(2),
                    'Ø§Ù„Ø³Ù„Ù (Ø¬.Ù…)': loans,
                    'Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª (Ø¬.Ù…)': rewards,
                    'Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª (Ø¬.Ù…)': deductions,
                    'ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨ (Ø¬.Ù…)': Math.round(netSalary)
                });
            });
            
            exportToExcel(data, 'ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª');
        }
        
        // ØªØµØ¯ÙŠØ± Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¹Ù‡Ø¯Ø©
        function exportCashToExcel() {
            const month = document.getElementById('filterCashMonth').value;
            const typeFilter = document.getElementById('filterCashType').value;
            
            let filteredTransactions = cashTransactions;
            
            if (month) {
                filteredTransactions = filteredTransactions.filter(transaction => 
                    transaction.date.startsWith(month)
                );
            }
            
            if (typeFilter) {
                filteredTransactions = filteredTransactions.filter(transaction => 
                    transaction.transactionType === typeFilter
                );
            }
            
            const data = filteredTransactions.map(transaction => {
                const baseData = {
                    'Ø§Ù„Ù†ÙˆØ¹': transaction.type,
                    'Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬.Ù…)': transaction.amount,
                    'Ø§Ù„ØªØ§Ø±ÙŠØ®': transaction.date,
                    'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„': transaction.supervisorName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    'Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©': transaction.transactionType === 'deposit' ? 'Ø¥ÙŠØ¯Ø§Ø¹' : 'ØµØ±Ù',
                    'Ù…Ù„Ø§Ø­Ø¸Ø§Øª': transaction.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'
                };
                
                if (transaction.transactionType === 'deposit') {
                    baseData['ÙØ¦Ø© Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹'] = transaction.category;
                } else if (transaction.transactionType === 'withdrawal') {
                    baseData['Ù†ÙˆØ¹ Ø§Ù„ØµØ±Ù'] = transaction.withdrawalType;
                    if (transaction.recipient) {
                        baseData['Ø§Ù„Ù…Ø³ØªÙ„Ù…'] = transaction.recipient;
                    }
                }
                
                return baseData;
            });
            
            exportToExcel(data, 'Ø­Ø±ÙƒØ§Øª_Ø§Ù„Ø¹Ù‡Ø¯Ø©');
        }
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Excel
        function exportToExcel(data, fileName) {
            try {
                const worksheet = XLSX.utils.json_to_sheet(data);
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, "Sheet1");
                XLSX.writeFile(workbook, `${fileName}.xlsx`);
                alert(`ØªÙ… ØªØµØ¯ÙŠØ± ${fileName} Ø¨Ù†Ø¬Ø§Ø­`);
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØµØ¯ÙŠØ±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
            }
        }

        // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
        window.editLeave = editLeave;
        window.deleteLeave = deleteLeave;
        window.editAttendance = editAttendance;
        window.deleteAttendance = deleteAttendance;
        window.editFinancial = editFinancial;
        window.deleteFinancial = deleteFinancial;
        window.editEmployee = editEmployee;
        window.toggleEmployeeStatus = toggleEmployeeStatus;
        window.callEmployee = callEmployee;
        window.sendWhatsAppToEmployee = sendWhatsAppToEmployee;
        window.activateEmployeeFromDatabase = activateEmployeeFromDatabase;
        window.editEmployeeInDatabase = editEmployeeInDatabase;
        window.deleteEmployeeFromDatabase = deleteEmployeeFromDatabase;
        window.showSalaryDetails = showSalaryDetails;
        window.sendWhatsAppMessage = sendWhatsAppMessage;
        window.exportEmployeeReportToExcel = exportEmployeeReportToExcel;
        window.sendEmployeeReportWhatsApp = sendEmployeeReportWhatsApp;
        window.editStation = editStation;
        window.deleteStation = deleteStation;
        window.editSupervisor = editSupervisor;
        window.deleteSupervisor = deleteSupervisor;
        window.editFault = editFault;
        window.deleteFault = deleteFault;
    </script>
    
    <!-- ØªØ¶Ù…ÙŠÙ† service worker Ø¯Ø§Ø®Ù„ Ù†ÙØ³ Ø§Ù„Ù…Ù„Ù Ù…Ø¹ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø§Ø¨Ø· -->
    <script>
        // Service Worker Ù„Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('https://yasminnmain44-design.github.io/Management/service-worker.js').catch(function(error) {
                console.log('ServiceWorker registration failed: ', error);
            });
            
            // Ø¥Ù†Ø´Ø§Ø¡ service worker Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
            const swCode = `
                const CACHE_NAME = 'attendance-cache-v1';
                const urlsToCache = [
                    'https://yasminnmain44-design.github.io/Management/',
                    'https://yasminnmain44-design.github.io/Management/index.html',
                    'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css',
                    'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js',
                    'https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js',
                    'https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js'
                ];

                self.addEventListener('install', function(event) {
                    event.waitUntil(
                        caches.open(CACHE_NAME)
                            .then(function(cache) {
                                console.log('Opened cache');
                                return cache.addAll(urlsToCache);
                            })
                    );
                });

                self.addEventListener('fetch', function(event) {
                    event.respondWith(
                        caches.match(event.request)
                            .then(function(response) {
                                if (response) {
                                    return response;
                                }
                                return fetch(event.request);
                            })
                    );
                });
            `;
            
            const blob = new Blob([swCode], { type: 'application/javascript' });
            const url = URL.createObjectURL(blob);
            
            navigator.serviceWorker.register(url).then(function(registration) {
                console.log('ServiceWorker registered successfully');
            }).catch(function(error) {
                console.log('ServiceWorker registration failed: ', error);
            });
        }
    </script>
</body>
</html>
